!function(t){function e(e){for(var r,s,o=e[0],c=e[1],u=e[2],f=0,h=[];f<o.length;f++)s=o[f],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&h.push(a[s][0]),a[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);for(l&&l(e);h.length;)h.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(r=!1)}r&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var r={},a={1:0},i=[];function s(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=r,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var o=window.webpackJsonp=window.webpackJsonp||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;i.push([797,0]),n()}({12:function(t,e,n){"use strict";n.d(e,"n",(function(){return c})),n.d(e,"m",(function(){return b})),n.d(e,"d",(function(){return w})),n.d(e,"c",(function(){return k})),n.d(e,"s",(function(){return u})),n.d(e,"l",(function(){return p})),n.d(e,"k",(function(){return h})),n.d(e,"r",(function(){return l})),n.d(e,"e",(function(){return x})),n.d(e,"o",(function(){return d})),n.d(e,"q",(function(){return v})),n.d(e,"p",(function(){return g})),n.d(e,"j",(function(){return m})),n.d(e,"i",(function(){return y})),n.d(e,"a",(function(){return f})),n.d(e,"f",(function(){return r})),n.d(e,"g",(function(){return a})),n.d(e,"h",(function(){return i})),n.d(e,"b",(function(){return S}));var r="troywell.org",a="https://".concat(r),i="".concat(a,"/landing/join"),s="https://ext.troywell.org",o="https://analytics.troywell.org",c=("".concat(a,"/api/configs/adblockBlackList"),"".concat(a,"/api/configs/adblockWhiteList"),{THANOS_CONFIG:"".concat(a,"/api/configs/thanos"),THANOS_CONFIG_MODIFIED_DATE:"".concat(a,"/api/configs/getLastModifiedDate/thanos"),ALLOWED_ADS_URL:"".concat(a,"/api/configs/adblockWhiteList"),ALLOWED_ADS_MODIFIED_DATE:"".concat(a,"/api/configs/getLastModifiedDate/adblockWhiteList"),ALLOWED_VIDEO_ADS_URL:"".concat(a,"/api/configs/adblockVideoBlack"),ALLOWED_VIDEO_ADS_MODIFIED_DATE:"".concat(a,"/api/configs/getLastModifiedDate/adblockVideoBlack"),BLOCK_ADS_URL:"".concat(a,"/api/configs/adblockBlackList"),BLOCK_ADS_MODIFIED_DATE:"".concat(a,"/api/configs/getLastModifiedDate/adblockBlackList"),VERSION_CHECK_URL:"https://static.troywell.org/uploads/06502463-99ba-4016-a9fd-58c13a0ba08a.json",TRANSLATIONS:"https://cdn.translations.troywell.org/translations/adblock/%language/translation.json",ANALYTIC_EXT_STATISTICS:"".concat(o,"/api/extension/ping"),EXTENSION_CREATION:"".concat(a,"/api/extension/create"),ANALYTIC_GA:"".concat(o,"/api/extension/ga"),ANALYTIC_PW_CHECK:"".concat(o,"/api/extension/rp"),ANALYTIC_SHOP_GOING:"".concat(o,"/api/extension/urls"),ANALYTIC_FEEDBACK:"".concat(o,"/api/adblock/feedback"),ANALYTIC_TRACKERS:"".concat(o,"/api/adblock/trackers"),UNINSTALL:"".concat(a,"/uninstall/"),APP_CONFIG_URL:"".concat(a,"/api/extensions/config"),PRIVACY_POLICY:"".concat(a,"/legal/adblock-agreement/")}),u={UNINSTALL:"".concat(a,"/uninstall/"),SERVERS_URL:"https://vpn-troywell-proxy.s3.us-west-1.amazonaws.com/vpn-list.json",TOKEN_URL:"https://auth.http-proxy.troywell.org/get-token",PRIVACY_POLICY:"".concat(a,"/legal/vpn-agreement/"),GET_COUNTRIES:"".concat(s,"/api/vpn/countries"),CONNECT_CHOISE:"".concat(s,"/api/vpn/connect/%county%"),DISCONNECT:"".concat(s,"/api/vpn/disconnect"),GET_GEOIP:"".concat(s,"/api/vpn/ip"),MOBILE_COUNTRIES:"https://proxy-api.troywell.org/v1/mobile/geo-list",MOBILE_CONNECT:"https://proxy-api.troywell.org/v1/mobile/proxy-list?country=%county%",RESIDENTIAL_COUNTRIES:"https://proxy-api.troywell.org/v1/wifi/geo-list",RESIDENTIAL_CONNECT:"https://proxy-api.troywell.org/v1/wifi/proxy-list?country=%county%",EXCLUDE_LIST:"https://troywell.org/api/configs/vpnExcludeList"},l="https://chrome.google.com/webstore/detail/free-vpn-for-chrome-troyw/adlpodnneegcnbophopdmhedicjbcgco",f="https://troywell.org/api/user/getBalanceByExtension?extensionId=",h=864e5,p=7*h,d=[12,3,6,9],v=[60,15,30,45],g=[20,5,10,15],m=3600,y=1200,b=["en","es","pl","pt","ru","vi","fr","it","de","pt_BR"],w="en",k={"Content-Type":"application/json"},x="AIzaSyCWEQ6eOZFY_Ls4Ont3KturBMLBhaV5mzw",S=("".concat(a,"/api/configs/adblockBlackList?label="),["google"])},15:function(t,e,n){"use strict";n.d(e,"v",(function(){return s})),n.d(e,"w",(function(){return o})),n.d(e,"q",(function(){return a})),n.d(e,"y",(function(){return L})),n.d(e,"r",(function(){return R})),n.d(e,"k",(function(){return C})),n.d(e,"h",(function(){return c})),n.d(e,"J",(function(){return D})),n.d(e,"d",(function(){return U})),n.d(e,"B",(function(){return M})),n.d(e,"t",(function(){return u})),n.d(e,"m",(function(){return f})),n.d(e,"u",(function(){return _})),n.d(e,"j",(function(){return d})),n.d(e,"H",(function(){return w})),n.d(e,"c",(function(){return h})),n.d(e,"A",(function(){return E})),n.d(e,"n",(function(){return A})),n.d(e,"l",(function(){return j})),n.d(e,"I",(function(){return T})),n.d(e,"e",(function(){return I})),n.d(e,"x",(function(){return N})),n.d(e,"z",(function(){return P})),n.d(e,"p",(function(){return g})),n.d(e,"g",(function(){return y})),n.d(e,"s",(function(){return l})),n.d(e,"i",(function(){return v})),n.d(e,"b",(function(){return p})),n.d(e,"G",(function(){return k})),n.d(e,"o",(function(){return m})),n.d(e,"f",(function(){return b})),n.d(e,"a",(function(){return B})),n.d(e,"C",(function(){return q})),n.d(e,"E",(function(){return x})),n.d(e,"D",(function(){return S})),n.d(e,"F",(function(){return O}));var r="troywell.org",a="https://".concat(r),i="https://analytics.troywell.org",s=("".concat(a,"/"),"".concat(a,"/privacy-policy")),o="".concat(a,"/redirect?v=").concat(encodeURIComponent(chrome.runtime.getManifest().version),"&link="),c="https://analytics.besttoolbars.net/api/v1/activity/vpn",u="".concat(a,"/api/offers"),l="".concat(a,"/api/masterOffers/getLastModifiedDate"),f="".concat(a,"/api/coupons"),h="".concat(a,"/api/configs/activateParams"),p="".concat(a,"/api/configs/getLastModifiedDate/activateParams"),d="".concat(a,"/api/configs/bestCAA/"),v="".concat(a,"/api/configs/getLastModifiedDate/bestCAA"),g="".concat(a,"/api/configs/domains"),m="".concat(a,"/api/configs/getLastModifiedDate/domains"),y="".concat(a,"/api/configs/blockingDomains"),b="".concat(a,"/api/configs/getLastModifiedDate/blockingDomains"),w="".concat(a,"/api/configs/thanos"),k="".concat(a,"/api/configs/getLastModifiedDate/thanos"),x="".concat(a,"/api/configs/terminator"),S="".concat(a,"/api/configs/getLastModifiedDate/terminator"),O=7776e6,D=("".concat(a,"/api/extension/create"),"https://cdn.translations.troywell.org/translations/troywell.org-caa/%lang%/translation.json"),T="".concat(a,"/api/transaction/create"),I=("".concat(a,"/coupon-auto-checker/uninstall-page/"),"".concat(i,"/api/extension/ping"),"".concat(i,"/api/extension/ga")),P="".concat(a,"/api/coupons/updateUsageStatus"),j={"Content-Type":"application/json"},L=[{name:"yahoo",domain:"search.yahoo.com",rx:/(..\.)?search\.yahoo\.com/,links:"h3 a",blocks:"div#web li > .dd:not(.bingrelqa)",secondaryLinks:".compList a.td-n"},{name:"bing",domain:"bing.com",rx:/(www(\d?).)?bing\.com/,links:"h2 a, div[class='sb_tlst'] * a",blocks:"#b_results>.b_algo",secondaryLinks:".b_vlist2col h3 a"},{name:"google",domain:"google.",rx:/^http(?:s)?:\/\/(?:www\.|encrypted\.)?google\..+/,links:"a",blocks:"div.g:not([data-hveid])",secondaryLinks:".nrgt a.l"}],R={init:"Show",success:"Success",fail:"Fail"},C={init:"Close",process:"Stop"},E=["en","es","pl","pt","pt_BR","ru","vi","fr","it","de"],A="en",_={API_URL:"https://pingapi.".concat(r,"/api/ping"),DELAY:9e5},U=("https://chrome.google.com/webstore/detail/".concat(chrome.runtime.id),["pwieu\\.com(?:.*)bt=25&tl=1","redirectingat\\.com(?:.*)id=78783X1529572&url=(?:.*)xcust=","pwieu\\.com(?:.*)targetCoupon(?:.*)tl=4","ad\\.admitad\\.com.*subid","alitems\\.com.*","lenkmio.com/g.*"]),M=[],N="".concat(a,"/api/auth/refresh-token"),B=[1e3,864e5,6048e5],q=864e5},379:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return P}));n(34),n(35),n(36),n(24),n(33),n(127),n(40),n(20),n(62),n(27),n(59),n(17),n(18),n(10),n(31);var r=n(25),a=n.n(r),i=(n(524),n(37),n(38),n(39),n(79),n(55),n(47),n(102),n(93),n(7)),s=n.n(i),o=n(1),c=n.n(o),u=(n(21),n(4)),l=n.n(u),f=n(9),h=n.n(f),p=n(13),d=n.n(p),v=n(380),g=n.n(v),m=n(117),y=n(381),b=n(382),w=n(383),k=n(386),x=n(387),S=n(391),O=n(8),D=n(12);function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function I(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var P=function(){function e(){var n=this;h()(this,e),this.settings={vpnOn:!1,country:"best",locations:[],valid:[],activeList:{},status:"off",blackListDomains:[],excludeListDomains:[],autoEnableListDomains:{},autoEnabled:!1,realGeoIP:{},lastLoations:[],proxyType:"DC",dcTiming:D.o[1],wifiTiming:D.q[1],mobileTiming:D.p[1],limitation:{date:(new Date).setHours(0,0,0,1),wifiTime:D.j}},this.fakeGeo={},this.disconnectTimeout=null,this.auth={},this.connectedProxy={},this.countries=new y.a,this.excludeListServer=new S.a,this.residential=new b.a,this.usageStatistic=new k.a,this.speedTest=new w.a,this.init().then(l()(c.a.mark((function e(){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"on"===n.settings.status&&(n.settings.status="off",n.setProxy()),e.next=3,n.countries.init();case 3:return e.next=5,n.excludeListServer.init();case 5:return n.residential.init(),n.restore(),n.onHeadersRecived(),n.initStatisticListeners(),n.initListeners(),e.next=12,n.checkGeoIP();case 12:n.settings.realGeoIP=e.sent,n.saveSettings(),n.analytics=new x.a({productType:t.app.app,customParams:{ip:null===(r=n.settings.realGeoIP)||void 0===r?void 0:r.ip},uninstallUrl:D.s.UNINSTALL+t.app.app}),n.resetSettingsToDefault(),n.resetLimitation();case 17:case"end":return e.stop()}}),e)}))))}var n,r,i,s,o,u,f,p,v,T,P;return d()(e,[{key:"init",value:(P=l()(c.a.mark((function t(){var e;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(O.k)("vpn.settings");case 2:e=t.sent,this.settings=I(I({},this.settings),e["vpn.settings"]);case 4:case"end":return t.stop()}}),t,this)}))),function(){return P.apply(this,arguments)})},{key:"checkStatus",value:function(){var t=this;chrome.proxy.settings.get({incognito:!1},(function(e){var n;t.settings.status="pac_script"===(null===(n=e.value)||void 0===n?void 0:n.mode)?"on":"off"}))}},{key:"initListeners",value:function(){var t=this;chrome.webRequest.onAuthRequired.addListener((function(e){var n,r,a,i;if(!e.isProxy)return{};if(!(null===(n=t.connectedProxy)||void 0===n?void 0:n.login)&&(null===(r=t.connectedProxy)||void 0===r?void 0:r.token)){var s=t.connectedProxy.token.split("").reduce((function(t,e){return t+String.fromCharCode(e.charCodeAt()+1)}),"").split(":");t.connectedProxy.login=s[0],t.connectedProxy.pass=s[1]}return{authCredentials:{username:(null===(a=t.connectedProxy)||void 0===a?void 0:a.login)||"",password:(null===(i=t.connectedProxy)||void 0===i?void 0:i.pass)||""}}}),{urls:["<all_urls>"]},["blocking"]),chrome.proxy.onProxyError.addListener((function(){!0!==navigator.onLine||t.isErrorHandling||(t.errorCounter=t.lastError&&t.lastError<Date.now()-3e4?0:t.errorCounter+1,t.lastError=Date.now(),20===t.errorCounter&&(t.isErrorHandling=!0,t.setProxy(t.settings.country,(function(){t.isErrorHandling=!1}))))}))}},{key:"setTimer",value:function(){var t=this;if(this.duration=0,"off"!==this.settings.status){var e=0;"LTE"===this.settings.proxyType&&(this.settings.limitation.mobileTime-=1,(e=60*this.settings.mobileTiming)>this.settings.limitation.mobileTime&&(e=this.settings.limitation.mobileTime)),"RS"===this.settings.proxyType&&(this.settings.limitation.wifiTime-=1,(e=60*this.settings.wifiTiming)>this.settings.limitation.wifiTime&&(e=this.settings.limitation.wifiTime));!function n(){var r=0;if(t.duration+=1,"DC"===t.settings.proxyType&&(r=60*t.settings.dcTiming*60-t.duration),"LTE"===t.settings.proxyType&&(t.settings.limitation.mobileTime-=1,r=e-t.duration),"RS"===t.settings.proxyType&&(t.settings.limitation.wifiTime-=1,r=e-t.duration),r/100==0&&t.saveSettings(),0===r)t.toggleVpn(),t.resetSettingsToDefault();else{var a,i=parseInt(r/60,10);a=i>99?"99+":0===i?"<1":i.toFixed(0),chrome.browserAction.setBadgeText({text:a})}t.timer=setTimeout((function(){return n()}),1e3)}()}}},{key:"toggleVpn",value:(T=l()(c.a.mark((function t(){var e,n,r=arguments;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:function(){},this.settings.status="on"===this.settings.status?"off":"on",t.next=4,this.setProxy(this.settings.country,e);case 4:return"off"===this.settings.status&&e("disconnect"),this.saveSettings(),this.usageStatistic.stop(),t.prev=7,t.next=10,Object(O.g)().then((function(t){return t}));case 10:n=t.sent,this.setIcon(new URL(null==n?void 0:n.url).hostname),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(7),this.setIcon();case 17:case"end":return t.stop()}}),t,this,[[7,14]])}))),function(){return T.apply(this,arguments)})},{key:"toggleAutoEnable",value:(v=l()(c.a.mark((function t(){var e;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.settings.autoEnabled=!this.settings.autoEnabled,this.setProxy(),this.saveSettings(),t.prev=3,t.next=6,Object(O.g)().then((function(t){return t}));case 6:e=t.sent,this.setIcon(new URL(null==e?void 0:e.url).hostname),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),this.setIcon();case 13:case"end":return t.stop()}}),t,this,[[3,10]])}))),function(){return v.apply(this,arguments)})},{key:"checkGeoIP",value:(p=l()(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(O.f)(D.s.GET_GEOIP,{timeout:1e4});case 3:return t.abrupt("return",t.sent.json());case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",{ok:!1});case 10:case"end":return t.stop()}}),t,null,[[0,6]])}))),function(){return p.apply(this,arguments)})},{key:"disconnect",value:(f=l()(c.a.mark((function t(){var e=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:chrome.proxy.settings.clear({scope:"regular"},(function(){var t,n;fetch(D.s.DISCONNECT,{method:"POST",body:JSON.stringify({country:null===(t=e.connectedProxy)||void 0===t?void 0:t.country,extId:null===(n=e.analytics)||void 0===n?void 0:n.extId}),headers:D.c}),e.cachedCoordinates={lat:"",lng:"",lang:""},e.cachedMap="",e.connectedProxy={}}));case 1:case"end":return t.stop()}}),t)}))),function(){return f.apply(this,arguments)})},{key:"getProxy",value:(u=l()(c.a.mark((function t(){var e,n,r,a,i,s,o,u,l=arguments;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>0&&void 0!==l[0]?l[0]:"best",t.next=3,fetch(D.s.CONNECT_CHOISE.replace("%county%",n),{method:"POST",body:JSON.stringify({country:this.settings.realGeoIP.countryCode,latitude:this.settings.realGeoIP.latitude,longitude:this.settings.realGeoIP.longitude,extId:null===(e=this.analytics)||void 0===e?void 0:e.extId,originalIp:this.settings.realGeoIP.ip,originalCountry:this.settings.realGeoIP.countryCode}),headers:D.c});case 3:return t.next=5,t.sent.json();case 5:if(t.t0=t.sent,t.t0){t.next=8;break}t.t0={};case 8:return r=t.t0,a=r.result,i=void 0===a?{}:a,s=r.ok,o=void 0===s||s,u=r.error,t.abrupt("return",Object.assign(i,{ok:o},{error:u}));case 15:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"getMobileOrResidentProxy",value:(o=l()(c.a.mark((function t(){var e,n,r,a=arguments;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=a.length>0&&void 0!==a[0]?a[0]:"us","LTE"===this.settings.proxyType?n=D.s.MOBILE_CONNECT:"RS"===this.settings.proxyType&&(n=D.s.RESIDENTIAL_CONNECT),t.next=4,fetch(n.replace("%county%",e),{method:"POST",body:JSON.stringify({country:this.settings.realGeoIP.countryCode,latitude:this.settings.realGeoIP.latitude,longitude:this.settings.realGeoIP.longitude}),headers:D.c});case 4:return t.next=6,t.sent.json();case 6:if(t.t0=t.sent,t.t0){t.next=9;break}t.t0={};case 9:return r=t.t0,t.abrupt("return",{country:r.country.country,ips:r.servers.map((function(t){return{ip:t.address,port:t.port}})),latitude:0,login:r.username,longitude:0,pass:r.password});case 11:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"setProxy",value:(s=l()(c.a.mark((function t(){var e,n,r,a=this,i=arguments;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=i.length>0&&void 0!==i[0]?i[0]:this.settings.country,r=i.length>1&&void 0!==i[1]?i[1]:function(){},!(null===(e=this.connectedProxy)||void 0===e?void 0:e.login)){t.next=5;break}return t.next=5,this.disconnect();case 5:chrome.proxy.settings.clear({scope:"regular"},l()(c.a.mark((function t(){var e;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.checkGeoIP();case 2:if(a.settings.realGeoIP=t.sent,"on"!==a.settings.status){t.next=17;break}if("LTE"!==a.settings.proxyType&&"RS"!==a.settings.proxyType){t.next=10;break}return t.next=7,a.getMobileOrResidentProxy(n);case 7:a.connectedProxy=t.sent,t.next=13;break;case 10:return t.next=12,a.getProxy(n);case 12:a.connectedProxy=t.sent;case 13:if(a.connectedProxy.ok||"no ip"!==a.connectedProxy.error){t.next=17;break}return a.fakeGeo={},a.settings.status="off",t.abrupt("return",r("no ip"));case 17:return e={mode:"pac_script",pacScript:{data:"\n              function FindProxyForURL(url, host) {\n                if(!url.match(/^(https?)|(ftp):\\/\\//)) return 'DIRECT';\n\n                url = url.toLowerCase();\n                host = host.toLowerCase();\n\n                var ip = dnsResolve(host);\n                if(\n                  isPlainHostName(host) \n                  || shExpMatch(host, '*.local') \n                  || isInNet(ip, '10.0.0.0', '255.0.0.0') \n                  || isInNet(ip, '172.16.0.0',  '255.240.0.0') \n                  || isInNet(ip, '192.168.0.0',  '255.255.0.0') \n                  || isInNet(ip, '173.37.0.0',  '255.255.0.0') \n                  || isInNet(ip, '127.0.0.0', '255.255.255.0')\n                ) return 'DIRECT';\n\n                ".concat(a.whiteList(),"\n\n                ").concat(a.proxyRow(),"\n\n                return 'DIRECT';\n              }\n             ")}},chrome.proxy.settings.set({value:e,scope:"regular"},l()(c.a.mark((function t(){var e;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.checkGeoIP();case 2:if(!(e=t.sent).ok||a.settings.realGeoIP.ip===e.ip){t.next=10;break}a.fakeGeo=e,a.connectedProxy=Object.assign(a.connectedProxy,e),r("success"),t.next=17;break;case 10:return r("fail"),a.fakeGeo={},a.settings.status="off",t.next=16,a.disconnect();case 16:chrome.browserAction.setBadgeText({text:""});case 17:clearTimeout(a.timer),a.setTimer(),a.setIcon(),a.setWebRTC();case 21:case"end":return t.stop()}}),t)})))),chrome.extension.isAllowedIncognitoAccess((function(t){if(t)try{chrome.proxy.settings.set({value:e,scope:"incognito_persistent"},(function(){}))}catch(t){}})),t.abrupt("return",!0);case 21:case"end":return t.stop()}}),t)}))));case 6:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"setWebRTC",value:function(){chrome.privacy.network.webRTCIPHandlingPolicy.set({value:"on"===this.settings.status?"disable_non_proxied_udp":"default"})}},{key:"onHeadersRecived",value:function(){var t=this;chrome.webRequest.onHeadersReceived.addListener((function(e){"off"===t.status||-1===e.tabId||t.settings.excludeListDomains.includes(e.initiator)||t.count(e.responseHeaders)}),{urls:["<all_urls>"]},["blocking","responseHeaders"]),chrome.webRequest.onBeforeRequest.addListener((function(e){var n,r,a;"off"===t.status||-1===e.tabId||t.settings.excludeListDomains.includes(e.initiator)||("POST"!==e.method&&"PUT"!==e.method||!(null===(n=e.requestBody)||void 0===n?void 0:n.raw)||t.update((null===(r=e.requestBody.raw[0])||void 0===r||null===(a=r.bytes)||void 0===a?void 0:a.byteLength)||0,!0))}),{urls:["<all_urls>"]},["blocking","requestBody"])}},{key:"initStatisticListeners",value:function(){var t=this;chrome.webNavigation.onCommitted.addListener((function(e){if(-1!==e.tabId&&e.url&&0===e.frameId){try{t.setIcon(new URL(null==e?void 0:e.url).hostname)}catch(e){t.setIcon()}"on"===t.settings.status&&t.usageStatistic.updateStatistic(e.url)}})),chrome.tabs.onActivated.addListener((function(e){var n=e.tabId;chrome.tabs.get(n,(function(e){var n=e.url;try{t.setIcon(new URL(n).hostname)}catch(e){t.setIcon()}"off"!==t.settings.status&&t.usageStatistic.updateStatistic(n)}))}))}},{key:"proxyRow",value:function(){if("off"===this.settings.status||!this.connectedProxy)return"";var t=g()(this.connectedProxy.ips).map((function(t){var e=t.ip,n=t.port;return"".concat(e,":").concat(n)})).join(";");return"return 'PROXY ".concat(t,"; DIRECT;'\n")}},{key:"whiteList",value:function(){var t=["localhost","vpn-api.troywell.org"].concat(a()(this.excludeListServer.data.map((function(t){return Object(m.toASCII)(t)}))),a()(this.settings.excludeListDomains.map((function(t){return Object(m.toASCII)(t)})))).flatMap((function(t){return["host == '".concat(t,"'"),"dnsDomainIs(host, '.".concat(t,"')")]})).join(" || ");return"if (host == '127.0.0.1' || ".concat(t,") return 'DIRECT';")}},{key:"securedWebsitesRow",value:function(){var t=this;return this.settings.autoEnabled?0===Object.keys(this.settings.autoEnableListDomains).length?"":Object.entries(this.settings.autoEnableListDomains).map((function(t){return{domain:Object(m.toASCII)(t[0]),country:t[1].country}})).flatMap((function(e){var n=e.domain,r=e.country;return["if(host == '".concat(n,"' ||\n        dnsDomainIs(host, '.").concat(n,"')) return '").concat(t.servers.getServersRow(r),"; DIRECT';")]})).join("\n"):""}},{key:"disableProxy",value:function(){var t=this;chrome.proxy.settings.clear({scope:"regular"},(function(){t.settings.status="off",chrome.privacy.network.webRTCIPHandlingPolicy.set({value:"default"})}))}},{key:"count",value:function(t){if(this.counter)for(var e in t){var n=t[e];if(n.name=n.name.toLowerCase(),n.value=n.value.toLowerCase(),"content-length"===n.name)return this.update(n.value),{cancel:!1}}}},{key:"update",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Number((Number(t)/1048576).toFixed(4)),r=Date.now(),a=864e5,i=7*a,s=30*a,o=e?this.uploadCounter:this.counter;r<o.day.end?o.day.bandwidth+=n:o.day={bandwidth:0,end:r+a},r<o.week.end?o.week.bandwidth+=n:o.week={bandwidth:0,end:r+i},r<o.month.end?o.month.bandwidth+=n:o.month={bandwidth:0,end:r+s},o.total.bandwidth+=n,e?this.uploadCounter=o:this.counter=o}},{key:"restore",value:function(){var t=Object(O.k)("bandwidth").bandwidth,e=Object(O.k)("uploadbandwidth").bandwidth,n=function(t){var e=Date.now(),n=864e5,r={total:{bandwidth:0},month:{bandwidth:0,end:e+2592e6},week:{bandwidth:0,end:e+6048e5},day:{bandwidth:0,end:e+n}},a={};return a["".concat(t,"bandwidth")]=r,Object(O.p)(a),r};this.counter=t||n(),this.uploadCounter=e||n()}},{key:"saveSettings",value:function(){var t={};t["vpn.settings"]=this.settings,Object(O.p)(t)}},{key:"updateAutoEnableList",value:(i=l()(c.a.mark((function t(e){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.settings.autoEnableListDomains[e]?delete this.settings.autoEnableListDomains[e]:this.settings.autoEnableListDomains[e]={country:"best"},this.saveSettings(),this.setProxy(),t.prev=3,t.next=6,Object(O.g)().then((function(t){return t}));case 6:n=t.sent,this.setIcon(new URL(null==n?void 0:n.url).hostname),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),this.setIcon();case 13:case"end":return t.stop()}}),t,this,[[3,10]])}))),function(t){return i.apply(this,arguments)})},{key:"updateExcludeList",value:(r=l()(c.a.mark((function t(e){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.settings.excludeListDomains.includes(e)?this.settings.excludeListDomains=this.settings.excludeListDomains.filter((function(t){return t!==e})):this.settings.excludeListDomains.push(e),this.saveSettings(),this.setProxy(this.settings.country),t.prev=3,t.next=6,Object(O.g)().then((function(t){return t}));case 6:n=t.sent,this.setIcon(new URL(null==n?void 0:n.url).hostname),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),this.setIcon();case 13:case"end":return t.stop()}}),t,this,[[3,10]])}))),function(t){return r.apply(this,arguments)})},{key:"updateLastLocations",value:function(t){if("best"!==t){if(this.settings.lastLoations.includes(t)){var e=this.settings.lastLoations.filter((function(e){return e!==t}));return e.push(t),this.settings.lastLoations=e,void this.saveSettings()}this.settings.lastLoations.push(t),this.settings.lastLoations.length>3&&this.settings.lastLoations.shift(),this.saveSettings()}}},{key:"updateLocation",value:(n=l()(c.a.mark((function t(e,n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.settings.country=e,this.updateLastLocations(e),this.saveSettings(),"off"!==this.settings.status){t.next=6;break}return n(),t.abrupt("return");case 6:return t.next=8,this.setProxy(this.settings.country,n);case 8:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"updateAutoEnableLocation",value:function(t,e){this.settings.autoEnableListDomains[e].country=t,this.saveSettings(),this.setProxy()}},{key:"setIcon",value:function(t){var e,n="";this.settings.excludeListDomains.find((function(e){return e===t}))?n="":(Object.keys(this.settings.autoEnableListDomains).find((function(e){return e===t}))&&this.settings.autoEnabled||(null===(e=this.fakeGeo)||void 0===e?void 0:e.ip))&&(n="green"),chrome.browserAction.setIcon({path:"icons/icon-128".concat(n,".png")})}},{key:"resetSettingsToDefault",value:function(){this.settings.country="best",this.settings.proxyType="DC",this.settings.dcTiming=D.o[1],this.settings.wifiTiming=D.q[1],this.settings.mobileTiming=D.p[1]}},{key:"resetLimitation",value:function(){Date.now()-this.settings.limitation.date>=D.k?(this.settings.limitation={date:(new Date).setHours(0,0,0,1),mobileTime:D.i,wifiTime:D.j},setTimeout(this.resetLimitation.bind(this),D.k)):setTimeout(this.resetLimitation.bind(this),D.k-(Date.now()-this.settings.limitation.date))}}]),e}()}).call(this,n(46))},381:function(t,e,n){"use strict";n.d(e,"a",(function(){return w}));n(29),n(30),n(10),n(45);var r=n(1),a=n.n(r),i=(n(21),n(4)),s=n.n(i),o=n(9),c=n.n(o),u=n(13),l=n.n(u),f=n(23),h=n.n(f),p=n(22),d=n.n(p),v=n(14),g=n.n(v),m=n(63),y=n(12);function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var a=g()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return d()(this,n)}}var w=function(t){h()(r,t);var e,n=b(r);function r(){return c()(this,r),n.call(this,{name:"countries",url:y.s.GET_COUNTRIES,updateDelay:36e5})}return l()(r,[{key:"init",value:(e=s()(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.update(!0);case 2:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"parse",value:function(t){return t.result||[]}}]),r}(m.a)},382:function(t,e,n){"use strict";n.d(e,"a",(function(){return w}));n(29),n(30),n(45),n(17),n(18),n(10),n(59),n(39),n(20);var r=n(1),a=n.n(r),i=(n(21),n(4)),s=n.n(i),o=n(9),c=n.n(o),u=n(13),l=n.n(u),f=n(23),h=n.n(f),p=n(22),d=n.n(p),v=n(14),g=n.n(v),m=n(63),y=n(12);function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var a=g()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return d()(this,n)}}var w=function(t){h()(r,t);var e,n=b(r);function r(){return c()(this,r),n.call(this,{name:"residential",url:y.s.RESIDENTIAL_COUNTRIES,updateDelay:864e5})}return l()(r,[{key:"init",value:(e=s()(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.update(!0);case 2:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"parse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.entries(t).map((function(t){return 0===t[1].length?null:{country:t[0],cities:t[1]}})).filter((function(t){return null!==t}))}}]),r}(m.a)},383:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));n(17),n(18),n(58),n(49),n(10);var r=n(1),a=n.n(r),i=(n(21),n(4)),s=n.n(i),o=n(9),c=n.n(o),u=n(13),l=n.n(u),f=n(384),h=n.n(f),p=n(305),d=n.n(p),v=n(16),g=n(8),m=function(){function t(){c()(this,t),this.serversUrl="https://troywell.speedtestcustom.com/api/js/servers?engine=js&limit=10&https_functional=true",this.guid=v.a.uuidv4(),this.status="",this.activeTestServer={cc:"RU",country:"Russia",distance:0,host:"speedtest.mosline.ru:8080",https_functional:1,id:"22121",lat:"55.7483",lon:"37.6171",name:"Moscow",preferred:0,sponsor:"MosLine Group LLC",url:"http://speedtest.mosline.ru:8080/speedtest/upload.php"},this.maxTime=5e4,this.maxPull=4,this.progress=0,this.ping=0,this.downloadSpeed=0,this.uploadSpeed=0}var e,n,r,i,o,u,f,p;return l()(t,[{key:"createConnectionObject",value:function(){var t=new XMLHttpRequest;return setTimeout((function(){t.abort()}),this.maxTime),t}},{key:"calculateSpeedAndProgress",value:function(t,e){var n=d()(e),r=(window.performance.now()-this.startTiming)/this.maxTime*100;return r>n&&(n=r),{speed:h()(t),progress:n}}},{key:"getTestServers",value:(p=s()(a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(this.serversUrl);case 2:return t.next=4,t.sent.json();case 4:e=t.sent,this.activeTestServer=e[0];case 6:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)})},{key:"pingRequest",value:(f=s()(a.a.mark((function t(){var e,n=this,r=arguments;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:this.createConnectionObject(),t.abrupt("return",new Promise((function(t){var r=window.performance.now();e.open("GET","https://".concat(n.activeTestServer.host,"/hello?nocache=").concat(v.a.uuidv4(),"&guid=").concat(n.guid),!0),e.timeout=15e3,e.send(),e.onload=function(){200===e.status&&t(parseInt(window.performance.now()-r,10))},e.onerror=function(){t(0)},e.ontimeout=function(){t(0)},e.onabort=function(){t(0)}})));case 2:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)})},{key:"pingTest",value:(u=s()(a.a.mark((function t(){var e,n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(this.status="ping",this.ping=0,e=[],n=0;n<this.maxPull;n++)e.push(this.pingRequest());return t.next=6,Promise.all(e);case 6:r=t.sent,this.ping=parseInt(d()(r)/this.maxPull);case 8:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"downloadTest",value:(o=s()(a.a.mark((function t(){var e,n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(this.status="download",this.startTiming=window.performance.now(),this.downloadSpeed=0,this.allDownloadSpeeds=[],this.allProgress=[],e=[],n=0;n<this.maxPull;n++)this.allProgress.push(n),e.push(this.downloadRequest(this.createConnectionObject(),n));return t.abrupt("return",Promise.all(e));case 8:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"uploadTest",value:(i=s()(a.a.mark((function t(){var e,n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(this.status="upload",this.startTiming=window.performance.now(),this.allUploadSpeeds=[],this.allProgress=[],e=[],n=0;n<this.maxPull;n++)this.allProgress.push(n),e.push(this.uploadRequest(this.createConnectionObject(),n));return t.abrupt("return",Promise.all(e));case 7:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"downloadRequest",value:(r=s()(a.a.mark((function t(){var e,n,r=this,i=arguments;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:this.createConnectionObject(),n=i.length>1?i[1]:void 0,t.abrupt("return",new Promise((function(t,a){var i=window.performance.now();e.open("GET","https://".concat(r.activeTestServer.host,"/download?nocache=").concat(v.a.uuidv4(),"&size=2500000&guid=").concat(r.guid),!0),e.timeout=6e4,e.responseType="blob",e.send(),e.onload=function(){200===e.status&&t()};var s=function(){var t=r.calculateSpeedAndProgress(r.allDownloadSpeeds,r.allProgress);r.downloadSpeed=t.speed,r.progress=t.progress};e.onprogress=function(t){t.lengthComputable?(r.allProgress[n]=parseFloat(t.loaded/t.total*100),r.allDownloadSpeeds[n]=t.loaded/(window.performance.now()-i)*8/1024):r.allProgress[n]=0,s()},e.onerror=function(){r.allProgress[n]=100,s(),t()},e.ontimeout=function(){r.allProgress[n]=100,s(),t()},e.onabort=function(){r.allProgress[n]=100,s(),t()}})));case 3:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"uploadRequest",value:(n=s()(a.a.mark((function t(){var e,n,r,i,s,o,c=this,u=arguments;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=u.length>0&&void 0!==u[0]?u[0]:this.createConnectionObject(),n=u.length>1?u[1]:void 0,r=new ArrayBuffer(25e4),i=[],s=0;s<10;s+=1)i.push(r);return o=new Blob(i,{type:"application/octet-stream"}),t.abrupt("return",new Promise((function(t,r){var a=window.performance.now();e.open("POST","".concat(c.activeTestServer.url,"?n=").concat(Math.random()),!0),e.setRequestHeader("Content-Type","application/octet-stream"),e.timeout=6e4,e.onload=function(){t()};var i=function(){var t=c.calculateSpeedAndProgress(c.allUploadSpeeds,c.allProgress);c.uploadSpeed=t.speed,c.progress=t.progress};e.upload.onprogress=function(t){t.lengthComputable?(c.allProgress[n]=parseFloat(t.loaded/t.total*100),c.allUploadSpeeds[n]=t.loaded/(window.performance.now()-a)*7/1024):c.allProgress[n]=0,i()},e.onerror=function(){c.allProgress[n]=100,i(),t()},e.ontimeout=function(){c.allProgress[n]=100,i(),t()},e.onabort=function(){c.allProgress[n]=100,i(),t()},e.send(o)})));case 7:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"start",value:(e=s()(a.a.mark((function t(){var e=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.progress=0,this.ping=0,this.downloadSpeed=0,this.uploadSpeed=0,this.status="ping",t.next=7,this.getTestServers();case 7:if(this.activeTestServer.host){t.next=9;break}return t.abrupt("return",setTimeout((function(){e.start()}),250));case 9:return t.next=11,this.pingTest();case 11:return t.next=13,this.downloadTest();case 13:return this.progress=0,this.status="upload",t.next=17,Object(g.d)(1e3);case 17:return t.next=19,this.uploadTest();case 19:this.status="";case 20:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),t}()},386:function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));n(34),n(35),n(36),n(33),n(47),n(55),n(103);var r=n(7),a=n.n(r),i=n(25),s=n.n(i),o=(n(58),n(91),n(60),n(24),n(94),n(20),n(59),n(39),n(17),n(18),n(10),n(31),n(102),n(1)),c=n.n(o),u=(n(21),n(4)),l=n.n(u),f=n(9),h=n.n(f),p=n(13),d=n.n(p),v=n(8);function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach((function(e){a()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var y=function(){function t(){h()(this,t),this.websites={},this.currentDomain="",this.currentSession=null,this.timer=null,this.loadStatistic()}var e;return d()(t,[{key:"updateTime",value:function(){var t=this;this.currentSession.time+=1,this.timer=setTimeout((function(){return t.updateTime()}),1e3)}},{key:"loadStatistic",value:(e=l()(c.a.mark((function t(){var e,n=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(v.k)("vpn.usageStatistic");case 2:e=t.sent,this.websites=e["vpn.usageStatistic"]||{},setTimeout((function(){return n.saveStatistic()}),15e3);case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"saveStatistic",value:function(){var t=this,e={};e["vpn.usageStatistic"]=this.websites,Object(v.p)(e),setTimeout((function(){return t.saveStatistic()}),15e3)}},{key:"stop",value:function(){clearTimeout(this.timer)}},{key:"getEndDate",value:function(t){var e=(new Date).setHours(0,0,0,0);return"week"===t&&(e=new Date(e).setDate(new Date(e).getDate()-7)),"month"===t&&(e=new Date(e).setMonth(new Date(e).getMonth()-1)),e}},{key:"getTotal",value:function(t){var e=this,n=this.getEndDate(t);return Object.keys(this.websites).reduce((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0,a=e.websites[r].reduce((function(t,e){return n>e.startDate+e.time?t:t+e.time}),0);return t+a}),0)}},{key:"getTop",value:function(t){var e=this.getEndDate(t),n=Object.entries(this.websites).map((function(t){var n=t[1].filter((function(t){return!(e>t.startDate+t.time)})),r=n.reduce((function(t,e){return t+e.time}),0);return{domain:t[0],totalTime:r,sessions:n}})).sort((function(t,e){return t.totalTime<e.totalTime?1:t.totalTime>e.totalTime?-1:0})).slice(0,4);return{websites:n,segments:this.getSegments(t,n,e).map((function(t){var e={};return t.forEach((function(t){e[t.domain]?e[t.domain].time+=t.time:e[t.domain]=t})),Object.values(e)}))}}},{key:"getSegments",value:function(t,e){var n="week"===t?Array.from(Array(7),(function(){return[]})):Array.from(Array(24),(function(){return[]}));"month"===t&&(n=Array.from(Array(4),(function(){return[]})));var r=[];return e.forEach((function(t){var e=t.sessions,n=t.domain;return r.push.apply(r,s()(e.map((function(t){return m(m({},t),{},{domain:n})}))))})),"week"===t?this.getByWeek(r,n):"month"===t?this.getByMonth(r,n)||[]:this.getByDay(r,n)}},{key:"getByDay",value:function(t,e){var n=s()(e);return t.forEach((function(t){var e=new Date(t.startDate),r=new Date(t.startDate+1e3*t.time);if(e.getHours()===r.getHours())n[e.getHours()].push(t);else{var a=Math.round((new Date(e).setHours(e.getHours()+1,0,0,0)-e)/1e3);if(n[e.getHours()].push(m(m({},t),{},{time:a})),t.time-a>86400)for(var i=0;i<Math.ceil((t.time-a)/60*60*24);i+=1)n[e.getHours()+i+1].push(m(m({},t),{},{time:86400}));else n[e.getHours()+1].push(m(m({},t),{},{time:t.time-a}))}})),n}},{key:"getByWeek",value:function(t,e){var n=s()(e);return t.forEach((function(t){var e=new Date(t.startDate),r=new Date(t.startDate+1e3*t.time),a=e.getDay()-1>-1?e.getDay()-1:6;if(e.getDay()===r.getDay())n[a].push(t);else if(e.getDay()<r.getDay()){var i=r.setHours(0,0,0,0);n[a].push(m(m({},t),{},{time:Math.round((i-e)/1e3)}))}})),n}},{key:"getByMonth",value:function(t,e){var n=s()(e);return t.forEach((function(t){var e=new Date(t.startDate),r=new Date(t.startDate+1e3*t.time);Math.floor(e.getDate()/7)===Math.floor(r.getDate()/7)&&n[Math.floor(e.getDate()/7)>3?3:Math.floor(e.getDate()/7)].push(t)})),n}},{key:"updateStatistic",value:function(t){var e=this,n=t.replace(/^(https?)?(:\/\/)?(www\.)?/,"").replace(/\/.*$/,"").replace(/\?.*$/,"").match(/^([a-zA-Z0-9]+(([\\-]?[a-zA-Z0-9]+)*\.)+)*[a-zA-Z]{2,}$/);if(!n||!n[0])return clearTimeout(this.timer),void(this.currentDomain={});if(this.currentDomain!==n[0]){if(this.currentSession={time:1,startDate:Date.now()},this.currentDomain=n[0],clearTimeout(this.timer),this.websites[this.currentDomain]&&this.websites[this.currentDomain].push(this.currentSession),!this.websites[this.currentDomain])return this.websites[this.currentDomain]=[],this.websites[this.currentDomain].push(this.currentSession),void(this.timer=setTimeout((function(){return e.updateTime()})));this.timer=setTimeout((function(){return e.updateTime()}),1e3)}}},{key:"clearHistory",value:function(t){var e=t.site,n=void 0===e?void 0:e,r=t.all;if(void 0!==r&&r)return this.websites={},void this.saveStatistic();delete this.websites[n],this.saveStatistic()}}]),t}()},387:function(t,e,n){"use strict";n.d(e,"a",(function(){return j}));n(27),n(67),n(40),n(39),n(50),n(24),n(37),n(38);var r=n(7),a=n.n(r),i=n(1),s=n.n(i),o=(n(21),n(4)),c=n.n(o),u=(n(47),n(9)),l=n.n(u),f=n(13),h=n.n(f),p=n(64),d=n.n(p),v=n(388),g=n.n(v),m=n(86),y=n.n(m),b=n(389),w=n.n(b),k=n(390),x=n.n(k),S=n(41),O=n.n(S),D=n(26),T=n.n(D),I=n(8),P=n(12),j=function(){function t(e){var n=this,r=e.productType,a=e.customParams,i=void 0===a?{}:a,s=e.uninstallUrl;l()(this,t),this.lastStatusUpdateKey="analytics.lastStatusUpdate",this.lastStatusUpdate=void 0,this.productType=r,this.settings={analyticsEnabled:!1,analyticsSelected:!1,pwWasLinked:!1,lastAsked:Date.now()},this.customParams=i,this.browser=Object(I.i)(),this.language=navigator.language.slice(0,2),this.os=navigator.platform,this.extVersion=chrome.runtime.getManifest().version,this.initAnalyticsSettings().then((function(){n.initExtensionStatusUpdate(),chrome.runtime.setUninstallURL("".concat(s,"?ext_id=").concat(n.extId)),n.initVisitsCollect()}))}var e,n,r,i,o,u;return h()(t,[{key:"loadLastStatusUpdate",value:(u=c()(s.a.mark((function t(){var e;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(I.k)(this.lastStatusUpdateKey);case 2:e=t.sent,this.lastStatusUpdate=T()(e,"".concat(this.lastStatusUpdateKey),1e3);case 4:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"saveLastStatusUpdate",value:function(){return Object(I.p)(a()({},this.lastStatusUpdateKey,this.lastStatusUpdate))}},{key:"toggleAnalytics",value:(o=c()(s.a.mark((function t(e){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.settings.analyticsEnabled=e,this.settings.analyticsSelected=!0,this.settings.lastAsked=Date.now(),this.saveAnalyticsSettings();case 4:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"saveAnalyticsSettings",value:function(){Object(I.p)({"analytics.settings":this.settings})}},{key:"getUTM",value:(i=c()(s.a.mark((function t(){var e,n,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(I.h)();case 2:return e=t.sent,n={},(r=d()(e,(function(t){var e=t.url;return e&&e.includes(chrome.runtime.id)&&e.includes("webstore")})))&&new URL(r.url).searchParams.forEach((function(t,e){void 0!==n[e]?(Array.isArray(n[e])||(n[e]=[n[e]]),n[e].push(t)):n[e]=t})),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"initAnalyticsSettings",value:(r=c()(s.a.mark((function t(){var e,n,r,a=this;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=T.a,t.next=3,Object(I.k)("extId");case 3:return t.t1=t.sent,this.extId=(0,t.t0)(t.t1,"extId"),t.t2=T.a,t.next=8,Object(I.k)("extPw");case 8:if(t.t3=t.sent,this.expPw=(0,t.t2)(t.t3,"extPw"),this.extId){t.next=19;break}return this.extId=x()(36).map((function(){return w()("abcdefghijklmnopqrstuvwxyz0123456789")})).join(""),Object(I.p)({extId:this.extId}),t.next=15,this.getUTM();case 15:e=t.sent,n={extension_id:this.extId,extension_version:this.extVersion,utm:e},this.extendWithUserData(n),fetch(P.n.EXTENSION_CREATION,{method:"POST",headers:P.c,body:JSON.stringify(n)}).then((function(t){return t.json()})).then((function(t){var e=t.message;e&&(a.expPw=e,Object(I.p)({extPw:e}),a.informPw())}));case 19:return t.next=21,Object(I.k)("analytics.settings");case 21:r=t.sent,this.settings=O()(this.settings,T()(r,"analytics.settings",{}));case 23:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"shouldUpdateExtensionStatus",value:function(){return!!(this.lastStatusUpdate&&Object(I.j)(this.lastStatusUpdate)>=12)}},{key:"extendWithUserData",value:function(t){var e={os:this.os,browser:this.browser,language:this.language||null,app:this.productType};O()(t,e,this.customParams)}},{key:"extensionStatusUpdate",value:(n=c()(s.a.mark((function t(){var e,n,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={extension_id:this.extId,extension_version:this.extVersion},this.extendWithUserData(e),t.next=4,fetch(P.n.ANALYTIC_EXT_STATISTICS,{method:"POST",body:JSON.stringify(e),headers:P.c});case 4:return t.next=6,t.sent.json();case 6:return n=t.sent,(r=n.data)&&!this.expPw&&(this.expPw=r,Object(I.p)({extPw:r}),this.informPw()),this.lastStatusUpdate=Date.now(),t.next=12,this.saveLastStatusUpdate();case 12:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"initExtensionStatusUpdate",value:(e=c()(s.a.mark((function t(){var e=this;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadLastStatusUpdate();case 2:if(!this.shouldUpdateExtensionStatus()){t.next=11;break}return t.prev=3,t.next=6,this.extensionStatusUpdate();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(3);case 11:this.updateInterval=setInterval((function(){e.shouldUpdateExtensionStatus()&&e.extensionStatusUpdate()}),36e5);case 12:case"end":return t.stop()}}),t,this,[[3,8]])}))),function(){return e.apply(this,arguments)})},{key:"initVisitsCollect",value:function(){var t=this;chrome.webNavigation.onBeforeNavigate.addListener((function(e){if(t.settings.analyticsEnabled&&0===e.frameId){if(P.b.find((function(t){return e.url.indexOf(t)>=0})))return;var n={url:e.url,extensionId:t.extId,extensionVersion:t.extVersion,app:t.productType};fetch(P.n.ANALYTIC_SHOP_GOING,{method:"POST",body:JSON.stringify(n),headers:P.c})}}))}},{key:"sendTrackers",value:function(t,e){var n=t.trackerCategories;if(0!==n.length&&this.settings.analyticsEnabled&&!P.b.find((function(t){return e.indexOf(t)>=0}))){var r=null;try{r=new URL(e).hostname}catch(t){}var a={extensionId:this.extId,extensionVersion:this.extVersion,domain:r};a.trackers=g()(y()(n,(function(t){return y()(t.trackers,(function(e){return{id:e.trackerID,name:e.name,blocked:e.blocked,type:t.id}}))}))[0]),fetch(P.n.ANALYTIC_TRACKERS,{method:"POST",body:JSON.stringify(a),headers:P.c})}}},{key:"informPw",value:function(){var t=this;this.extId&&this.expPw&&!this.settings.pwWasLinked&&fetch(P.n.ANALYTIC_PW_CHECK,{method:"POST",body:JSON.stringify({extensionId:this.extId,data:this.expPw}),headers:P.c}).then((function(t){return t.json})).then((function(){t.settings.pwWasLinked=!0,t.saveAnalyticsSettings()}))}}]),t}()},391:function(t,e,n){"use strict";n.d(e,"a",(function(){return w}));n(29),n(30),n(10),n(45);var r=n(1),a=n.n(r),i=(n(21),n(4)),s=n.n(i),o=n(9),c=n.n(o),u=n(13),l=n.n(u),f=n(23),h=n.n(f),p=n(22),d=n.n(p),v=n(14),g=n.n(v),m=n(63),y=n(12);function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var a=g()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return d()(this,n)}}var w=function(t){h()(r,t);var e,n=b(r);function r(){return c()(this,r),n.call(this,{name:"excludeList",url:y.s.EXCLUDE_LIST,updateDelay:144e5})}return l()(r,[{key:"init",value:(e=s()(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.update(!0);case 2:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"parse",value:function(t){return t||[]}}]),r}(m.a)},393:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return w}));n(34),n(35),n(36),n(24),n(20),n(33),n(17),n(18),n(10),n(31),n(47);var r=n(7),a=n.n(r),i=n(1),s=n.n(i),o=(n(21),n(4)),c=n.n(o),u=(n(127),n(9)),l=n.n(u),f=n(13),h=n.n(f),p=n(26),d=n.n(p),v=n(16),g=n(15),m=n(8);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){a()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w=function(){function e(t){var n=t.authService,r=t.sessionsStore;l()(this,e),this.extId=void 0,this.authService=n,this.extVersion=chrome.runtime.getManifest().version,this.sessionsStore=r,this.transactions=[],this.init=this.init.bind(this)}var n,r;return h()(e,[{key:"init",value:(r=c()(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=d.a,t.next=3,Object(v.f)("extId");case 3:if(t.t1=t.sent,this.extId=(0,t.t0)(t.t1,"extId"),this.extId){t.next=8;break}return t.next=8,Object(m.a)(this.init,3e3);case 8:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"createTransaction",value:(n=c()(s.a.mark((function e(n){var r,a,i,o,c,u,l,f,h,p,d,v,m,y,w,k,x,S;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.merchantId,u=void 0===c?"":c,l=n.network,f=void 0===l?"":l,h=n.activationType,p=void 0===h?"":h,d=n.sa2,v={network:f,offer_id:u,extension_id:this.extId,activationType:p,app:t.app.app,clickSource:d,extVersion:this.extVersion},y={"x-real-ip":null===(r=t.app)||void 0===r||null===(a=r.vpn)||void 0===a||null===(i=a.settings)||void 0===i||null===(o=i.realGeoIP)||void 0===o?void 0:o.ip},e.prev=3,e.next=6,this.authService.getAuthHeader();case 6:w=e.sent,m=b(b(b({},g.l),w),y),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),m=b(b({},g.l),y);case 13:return e.next=15,fetch(g.I,{headers:m,method:"POST",body:JSON.stringify(v)});case 15:if(!(k=e.sent).ok){e.next=22;break}return e.next=19,k.json();case 19:return x=e.sent,u&&(S={merchantId:u,data:{shoppingTrip:x.transaction_id,deepLink:x.deepLink,lastActivation:Date.now()}},this.sessionsStore.updateSession(S)),e.abrupt("return",{deepLink:x.deepLink});case 22:return e.abrupt("return",{deepLink:null});case 23:case"end":return e.stop()}}),e,this,[[3,10]])}))),function(t){return n.apply(this,arguments)})}]),e}()}).call(this,n(46))},397:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return I}));n(29),n(30),n(10),n(45);var r=n(7),a=n.n(r),i=n(1),s=n.n(i),o=(n(21),n(4)),c=n.n(o),u=(n(27),n(9)),l=n.n(u),f=n(13),h=n.n(f),p=n(23),d=n.n(p),v=n(22),g=n.n(v),m=n(14),y=n.n(m),b=n(41),w=n.n(b),k=n(26),x=n.n(k),S=n(16),O=n(8),D=n(15);function T(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var a=y()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return g()(this,n)}}var I=function(e){d()(u,e);var n,r,i,o=T(u);function u(t){var e;l()(this,u),e=o.call(this,t);var n=t.transactionService,r=t.sessionsStore,a=t.settings,i=t.getLanguage;return e.name="analytics",e.lastStatusUpdateKey="".concat(e.name,".lastStatusUpdate"),e.lastStatusUpdate=void 0,e.transactionService=n,e.sessionsStore=r,e.settings=a,e.browser=Object(O.i)(),e.os=navigator.platform,e.extVersion=chrome.runtime.getManifest().version,e.getLanguage=i,e}return h()(u,[{key:"send",value:function(t){this.settings.isAnalyticsEnabled&&this.sendCouponsAnalyticsGA(t)}},{key:"loadLastStatusUpdate",value:(i=c()(s.a.mark((function t(){var e;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(S.f)(this.lastStatusUpdateKey);case 2:e=t.sent,this.lastStatusUpdate=x()(e,"".concat(this.dataKey));case 4:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"saveLastStatusUpdate",value:function(){return Object(O.q)(a()({},this.lastStatusUpdateKey,this.lastStatusUpdate))}},{key:"shouldUpdateExtensionStatus",value:function(){return!(this.lastStatusUpdate&&Object(O.j)(this.lastStatusUpdate)>=12)}},{key:"extendWithUserData",value:function(e){if(this.settings.isAnalyticsEnabled){var n={os:this.os,browser:this.browser,language:this.getLanguage()||null,app:t.app.app};w()(e,n)}}},{key:"sendMerchantVisit",value:(r=c()(s.a.mark((function t(e){var n,r,a,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.session,r=e.merchantName,a=n.merchantId,i={offer_id:a,extension_id:this.transactionService.extId},this.extendWithUserData(i),r&&this.send({ec:"Visited merchant",ea:"Visit",el:r});case 5:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"sendCouponsAnalyticsGA",value:(n=c()(s.a.mark((function t(e){var n,r,a,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.el,r=e.ec,a=e.ea,i={category:r,label:n,action:a,extension_id:this.transactionService.extId,extension_version:this.extVersion},this.extendWithUserData(i),t.next=5,fetch(D.e,{method:"POST",body:JSON.stringify(i),headers:D.l});case 5:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})}]),u}(S.a)}).call(this,n(46))},5:function(t,e,n){"use strict";n.d(e,"n",(function(){return o})),n.d(e,"d",(function(){return s})),n.d(e,"m",(function(){return c})),n.d(e,"i",(function(){return u})),n.d(e,"k",(function(){return f})),n.d(e,"l",(function(){return h})),n.d(e,"e",(function(){return p})),n.d(e,"a",(function(){return k})),n.d(e,"c",(function(){return d})),n.d(e,"b",(function(){return v})),n.d(e,"j",(function(){return l})),n.d(e,"g",(function(){return y})),n.d(e,"h",(function(){return b})),n.d(e,"f",(function(){return w}));n(47),n(20),n(94),n(39),n(50),n(366),n(103),n(304),n(37),n(38),n(29),n(30),n(55),n(67),n(1),n(21),n(4);var r=n(25),a=n.n(r),i=(n(49),n(10),function(t,e){return function(){var n=Array.prototype.slice.call(arguments);return new Promise((function(r){n.push((function(){return chrome.runtime.lastError,r.apply(void 0,arguments)})),t[e].apply(t,a()(n))}))}}),s=(i(chrome.tabs,"query"),i(chrome.tabs,"remove"),i(chrome.windows,"getCurrent"),i(chrome.cookies,"getAll"),i(chrome.storage.local,"get")),o=i(chrome.storage.local,"set"),c=(i(chrome.tabs,"create"),i(chrome.tabs,"update"),i(chrome.runtime,"sendMessage")),u=(i(chrome.tabs,"sendMessage"),function(t,e,n){var r=Math.floor(t/60),a=Math.round(t%60),i=r?"".concat(r).concat(e):"",s=a?"".concat(a).concat(n):"";return"".concat(i," ").concat(s," ")}),l=function(t){var e=Math.floor(t/60),n=Math.round(t%60);return"".concat(e,":").concat(n," ")},f=function(t){var e=t.price,n=t.rate;return Math.ceil(e/n)},h=function(t){return t?t.toString().replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 "):""},p=function(t){return t.flights_baggage&&t.flights_baggage.count&&"no"!==t.flights_baggage.param},d=function(t){if(!t)return t;var e="".concat(t);e.toString().includes(",")&&!e.toString().includes(".")&&(e=e.toString().replace(",","."));var n=(e=(e=e.replace(/^\$|^€/gim,"").replace("€","").replace("$","").replace(/₽|\$|€|¥|£|₣/,"").replace(/[.,]+$/,"").replace(/[^\d.,\n]/gim,"").replace(/\n/gim,"").trim()).substr(e.length-3).match(/,|\./g)?e:e.replace(/,|\./g,"")).indexOf(","),r=e.indexOf(".");return n>r?e=e.replace(".","").replace(",","."):(n<r||r<0)&&(e=e.replace(",","")),parseFloat(e)||void 0},v=function(t){return t.isOnly?"only":t.value?"on":"off"},g=function(t){var e=t&&t.match(/(\d)PC(.*)/);return e?{count:e[1],param:function(t){return t?t.startsWith("x")?"dimensions":t:"count"}(e[2])}:{count:0,param:"no"}},m=function(t){return t.every((function(t,e,n){return t[0]===n[0][0]}))?t[0][0]:null},y=function(t){return function(t){var e=t.baggage,n=t.handbags;return{flights_baggage:g(m(e)),flights_handbags:g(m(n))}}({baggage:t.flights_baggage,handbags:t.flights_handbags})},b=function(t,e){var n=function(t,e){return t.map((function(t){return{key:t[0],flights_baggage:g(m(t[1].flights_baggage)),flights_handbags:g(m(t[1].flights_handbags)),price:f({price:t[1].unified_price,rate:e}),url:t[1].url}}))}(t,e).filter((function(t){return p(t)})).sort((function(t,e){return t.price-e.price}));return!(!n||!n.length)&&n[0]},w=function(t){var e,n,r,a=t.luggageInfo,i=t.luggageOption,s=a.flights_baggage.count>0||(null==i||null===(e=i.flights_baggage)||void 0===e?void 0:e.count)>0,o=a.flights_handbags.count>0||(null==i||null===(n=i.flights_handbags)||void 0===n?void 0:n.count)>0;return s&&o?r=1:s||(r=2),r},k=function(t,e){return new Promise((function(n){var r="savematic-event-".concat(parseInt(1e3*Math.random(),10),"-").concat(Date.now());window.addEventListener(r,(function t(e){var a;window.removeEventListener(r,t),n((null==e||null===(a=e.detail)||void 0===a?void 0:a.replace(/"/g,""))||null),i&&i.parentNode.removeChild(i)}));var a="\n      getPropSM = (object, keys, defaultVal = null) => {\n        keys = Array.isArray(keys) ? keys : keys.replace(/(\\[(\\d)\\])/g, '.$2').split('.');\n        object = object[keys[0]];\n        if (object && keys.length > 1) {\n          return getPropSM(object, keys.slice(1), defaultVal);\n        }\n        return object === undefined ? defaultVal : object;\n      };\n      ".concat("(function(callback, eventName, timeout) {  if (typeof window.CustomEvent !== \"function\") {    const CustomEvent = function(event, params) {      params = params || {        bubbles: false,        cancelable: false,        detail: null      };      var evt = document.createEvent('CustomEvent');      evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);      return evt;    };    CustomEvent.prototype = window.Event.prototype;    window.CustomEvent = CustomEvent;  }  let run = false;  const handle = function() {    if (run) {      return;    }    run = true;    const e = new CustomEvent(eventName, {      detail: JSON.stringify(callback())    });    window.dispatchEvent(e);  };    if(timeout) {   setTimeout(handle, timeout);  } else {   handle();  }})(").concat(["string"!=typeof t?t.toString():t,JSON.stringify(r),JSON.stringify(e||void 0)].join(","),");"),i=document.createElement("script");i.innerHTML=a,document.body.appendChild(i)}))}},63:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));n(29),n(30),n(10),n(27);var r=n(9),a=n.n(r),i=n(13),s=n.n(i),o=n(41),c=n.n(o),u=n(8),l=function(){function t(e){a()(this,t);var n=e.name,r=e.url,i=e.options,s=e.updateDelay,o=e.errorDelay,c=e.checkDelay;this.name=n,this.url=r,this.options=i||{},this.updateDelay=s||144e5,this.errorDelay=o||this.updateDelay/10,this.checkDelay=c||6e5,this.data=null,this.lastUpdate=null}return s()(t,[{key:"parse",value:function(t){return t}},{key:"fetch",value:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){var n=e?c()(this.options,e):this.options;return fetch(t||this.url,n).then((function(t){return t.json()}))}))},{key:"update",value:function(t){var e=this;return clearTimeout(this.updateInterval),Object(u.k)(["".concat(this.name,".lastUpdate"),"".concat(this.name,".data")]).then((function(n){var r=n["".concat(e.name,".lastUpdate")],a=n["".concat(e.name,".data")],i=(new Date).getTime();return r+e.updateDelay>=i&&a&&!t?(e.data=a,e.updateInterval=setTimeout((function(){return e.update()}),e.checkDelay),e.data):e.fetch().then((function(t){return e.parse(t)})).then((function(t){if(t){e.data=t,e.lastUpdate=i;var n={};n["".concat(e.name,".data")]=t,n["".concat(e.name,".lastUpdate")]=i,Object(u.p)(n),e.updateInterval=setTimeout((function(){return e.update()}),e.checkDelay)}else e.updateInterval=setTimeout((function(){return e.update(!0)}),e.checkDelay);return e.data})).catch((function(t){e.data=a,e.updateInterval=setTimeout((function(){return e.update(!0)}),e.errorDelay)}))}))}}]),t}()},797:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return Ie}));n(29),n(30),n(10),n(45),n(37),n(38),n(40),n(24),n(79);var r=n(1),a=n.n(r),i=(n(21),n(4)),s=n.n(i),o=n(9),c=n.n(o),u=n(13),l=n.n(u),f=n(81),h=n.n(f),p=n(23),d=n.n(p),v=n(22),g=n.n(v),m=n(14),y=n.n(m),b=(n(34),n(35),n(36),n(20),n(33),n(17),n(18),n(31),n(7)),w=n.n(b),k=(n(49),n(39),n(27),n(95)),x=n.n(k),S=n(264),O=n.n(S),D=n(375),T=n.n(D),I=n(265),P=n.n(I),j=n(26),L=n.n(j),R=n(96),C=n.n(R),E=n(376),A=n.n(E),_=n(8),U=function(){function t(e){c()(this,t),this.name="thanos",this.data={},this.configs=P()(T()(O()(e.configs[0]||{}))),this.browser=e.browser,this.state=!1,this.allExt=[],this.blockedExtensions=[],this.ignoreId="",this.init()}var e,n,r,i,o,u;return l()(t,[{key:"init",value:(u=s()(a.a.mark((function t(){var e=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getAllExtension();case 2:return this.allExt=t.sent,t.t0=L.a,t.next=6,this.getSelf();case 6:return t.t1=t.sent,this.ignoreId=(0,t.t0)(t.t1,"id"),t.next=10,this.load();case 10:chrome.management.onInstalled.addListener((function(){e.toggleVpns()})),chrome.management.onEnabled.addListener((function(){e.toggleVpns()}));case 12:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"load",value:function(){var t=this;return new Promise((function(e){Object(_.k)(["".concat(t.name,".blockedExtensions")]).then((function(n){t.blockedExtensions=n["".concat(t.name,".blockedExtensions")]||[],e(!0)}))}))}},{key:"save",value:function(){Object(_.p)(w()({},"".concat(this.name,".blockedExtensions"),this.blockedExtensions))}},{key:"controller",value:(o=s()(a.a.mark((function t(e){var n=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.checkState();case 2:if(this.state){t.next=4;break}return t.abrupt("return");case 4:if(!e){t.next=9;break}return t.next=7,x()(this.blockedExtensions,(function(t){var r=t.id;return n.toggleExtension(r,e),!0}));case 7:t.next=14;break;case 9:return t.next=11,this.getAllExtension();case 11:return this.allExt=t.sent,t.next=14,C()(A()(this.configs,this.allExt),(function(t){n.toggleExtension(t,e)}));case 14:this.save();case 15:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"getAllExtension",value:(i=s()(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){try{chrome.management.getAll&&chrome.management.getAll((function(e){var n=e.filter((function(t){return t.enabled}));t(n.map((function(t){return t.id})))}))}catch(t){}})));case 1:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"getSelf",value:(r=s()(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){try{chrome.management.getSelf(t)}catch(t){}})));case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"toggleExtension",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{if(t===this.ignoreId)return;chrome.management.setEnabled(t,n),n||chrome.management.get(t,(function(t){e.blockedExtensions.push(t)}))}catch(t){}}},{key:"checkState",value:(n=s()(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.state="yabrowser"!==this.browser&&"firefox"!==this.browser&&!!chrome.management.getAll;case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"toggleVpns",value:(e=s()(a.a.mark((function t(){var e=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=L.a,t.next=4,this.getSelf();case 4:if(t.t1=t.sent,this.ignoreId=(0,t.t0)(t.t1,"id"),this.ignoreId){t.next=8;break}return t.abrupt("return");case 8:chrome.management.getAll((function(t){t.filter((function(t){var e=t.enabled,n=t.permissions,r=t.name;return e&&n.find((function(t){return"proxy"===t}))&&!r.toLowerCase().includes("troywell")})).forEach((function(t){var n=t.id;n!==e.ignoreId&&chrome.management.setEnabled(n,!1)}))})),t.next=14;break;case 11:t.prev=11,t.t2=t.catch(0);case 14:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return e.apply(this,arguments)})}]),t}(),M=(n(55),n(80)),N=n.n(M),B=n(377),q=n.n(B),G=n(378),V=n.n(G),H=n(12),F=n(63);function K(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var a=y()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return g()(this,n)}}var W=function(t){d()(r,t);var e,n=K(r);function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=e.lang,i=void 0===a?navigator.language.slice(0,2):a,s=e.prefix;return c()(this,r),t=s?n.call(this,{name:"".concat(s,"_translations")}):n.call(this,{name:"translations"}),Object(_.k)("app.settings").then((function(e){var n,r=(null===(n=e["app.settings"])||void 0===n?void 0:n.language)||i;H.m.includes(r)?t.language=r:t.language=H.d})),g()(t)}return l()(r,[{key:"setLanguage",value:(e=s()(a.a.mark((function t(e){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return H.m.includes(e)?this.language=e:this.language=H.d,t.next=3,this.update(!0);case 3:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"fetch",value:function(){var t=H.n.TRANSLATIONS.replace("%language","pt_BR"===this.language?"pt-BR":this.language);return h()(y()(r.prototype),"fetch",this).call(this,t)}},{key:"handleDoubleCurlyBracers",value:function(t){var e=this;V()(t,(function(n,r){t[r]&&(q()(t[r])?t[r]=t[r].replace(/{{/g,"{").replace(/}}/g,"}"):N()(t[r])&&e.handleDoubleCurlyBracers(t[r]))}))}},{key:"parse",value:function(t){return this.handleDoubleCurlyBracers(t),t}}]),r}(F.a),J=n(19),Y=n.n(J),z=(n(58),n(93),n(47),n(86)),$=n.n(z);function X(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var a=y()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return g()(this,n)}}var Z=function(t){d()(i,t);var e,n,r=X(i);function i(){var t;return c()(this,i),(t=r.call(this,{name:"configs",url:"example.com"})).modifiedDates={},t}return l()(i,[{key:"init",value:function(){var t=this;return new Promise((function(e){t.load().then(s()(a.a.mark((function n(){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.update();case 2:e();case 3:case"end":return n.stop()}}),n)}))))}))}},{key:"getLastModifiedDate",value:(n=s()(a.a.mark((function t(e){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e);case 3:return n=t.sent,t.next=6,n.json();case 6:return r=t.sent,t.abrupt("return",+r.data);case 10:return t.prev=10,t.t0=t.catch(0),t.abrupt("return",0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])}))),function(t){return n.apply(this,arguments)})},{key:"load",value:function(){var t=this;return new Promise((function(e){Object(_.k)(["".concat(t.name,".lastUpdate"),"".concat(t.name,".modifiedDates"),"".concat(t.name,".data")]).then((function(n){t.lastUpdate=n["".concat(t.name,".lastUpdate")]||0,t.modifiedDates=n["".concat(t.name,".modifiedDates")]||{},t.data=n["".concat(t.name,".data")],e(!0)}))}))}},{key:"refreshUpdateTimer",value:function(t){var e=this,n=t.time,r=void 0===n?Date.now():n,a=t.interval,i=void 0===a?this.updateDelay:a,s=t.force;clearInterval(this.updateTimer),this.lastUpdate=r,this.save(),this.updateTimer=setInterval((function(){clearInterval(e.updateTimer),e.update(s)}),r+i-Date.now())}},{key:"update",value:(e=s()(a.a.mark((function t(e,n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.lastUpdate+this.updateDelay<Date.now()||e)){t.next=13;break}return t.prev=1,t.next=4,this.fetch({options:n});case 4:this.refreshUpdateTimer({}),this.errorDelay=3e4,t.next=13;break;case 8:t.prev=8,t.t0=t.catch(1),this.errorDelay*=Math.floor(5*Math.random())+2,this.refreshUpdateTimer({interval:this.errorDelay,force:!0});case 13:this.refreshUpdateTimer({time:this.updateTime});case 14:case"end":return t.stop()}}),t,this,[[1,8]])}))),function(t,n){return e.apply(this,arguments)})},{key:"save",value:function(){var t;Object(_.p)((t={},w()(t,"".concat(this.name,".lastUpdate"),this.lastUpdate),w()(t,"".concat(this.name,".modifiedDates"),this.modifiedDates),w()(t,"".concat(this.name,".data"),this.data),t))}},{key:"fetch",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(s()(a.a.mark((function t(){var e,n,r,i,o,c=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.updateController&&this.updateController.abort(),this.updateController=new AbortController,e=function(){var t=s()(a.a.mark((function t(e){var n,r,i,s,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.url,r=e.modifiedUrl,t.next=3,c.getLastModifiedDate(r);case 3:if(i=t.sent,s=n.split("/").pop(),i!==c.modifiedDates[s]){t.next=7;break}return t.abrupt("return");case 7:return c.modifiedDates[s]=i,t.prev=8,t.next=11,fetch(n);case 11:if(200===(o=t.sent).status){t.next=14;break}throw Error("invalid status");case 14:return t.abrupt("return",o.json());case 17:return t.prev=17,t.t0=t.catch(8),t.abrupt("return",[]);case 20:case"end":return t.stop()}}),t,null,[[8,17]])})));return function(e){return t.apply(this,arguments)}}(),n=$()([{url:H.n.THANOS_CONFIG,modifiedUrl:H.n.THANOS_CONFIG_MODIFIED_DATE}],(function(t){return e(t,{signal:c.updateController})})),t.next=6,Promise.all(n);case 6:r=t.sent,i=Y()(r,1),o=i[0],this.data={thanosConfig:o},this.save();case 10:case"end":return t.stop()}}),t,this)}))))}]),i}(F.a);function Q(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var a=y()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return g()(this,n)}}var tt=function(t){d()(r,t);var e,n=Q(r);function r(){return c()(this,r),n.call(this,{name:"balance",updateDelay:36e5})}return l()(r,[{key:"init",value:(e=s()(a.a.mark((function t(){var e,n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_.k)("extId");case 2:if(e=t.sent,n=e.extId){t.next=8;break}return t.next=7,Object(_.d)(100);case 7:return t.abrupt("return",this.init());case 8:return this.url=H.a+n,t.abrupt("return",this.update(!0));case 10:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"parse",value:function(t){var e=t.data,n=e.approved,r=e.pending;return{approved:parseInt(n,10)||0,pending:parseInt(r,10)||0}}}]),r}(F.a),et=n(97),nt=n.n(et),rt=function(){function t(){c()(this,t),this.type="basic",this.showDelay=864e5,this.name="notifications"}var e,n;return l()(t,[{key:"init",value:(n=s()(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_.k)(["".concat(this.name,".lastShow")]);case 2:t.sent["".concat(this.name,".lastShow")]||Object(_.p)(w()({},"".concat(this.name,".lastShow"),1)),this.setEvents();case 6:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"setEvents",value:function(){var t=this;chrome.notifications.onClicked.addListener((function(e){"enableVideo"===e&&t.enableVideoBlock()}))}},{key:"sendNotification",value:(e=s()(a.a.mark((function t(e){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_.k)(["".concat(this.name,".lastShow")]);case 2:if(n=t.sent,r=n["".concat(this.name,".lastShow")],!(nt()()-r<this.showDelay)){t.next=6;break}return t.abrupt("return");case 6:this.createNotification(e);case 7:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"createNotification",value:function(t){var e=this,n=t.id,r=t.title,a=t.message,i=t.iconUrl,s=t.background,o={type:this.type,title:r,message:a,iconUrl:i||"icons/icon-128.png"};"image"===this.type&&(o.imageUrl=s||i),chrome.notifications.create(n,o,(function(){Object(_.p)(w()({},"".concat(e.name,".lastShow"),nt()()))}))}}]),t}();function at(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function it(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?at(Object(n),!0).forEach((function(e){w()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var st=function(){function t(){c()(this,t),this.browser=Object(_.i)(),this.translations=new W,this.balance=new tt,this.fallbackTranslations=new W({prefix:"fallback",lang:H.d}),this.configs=new Z,this.notification=new rt,this.settings={topMessageIsClosed:!1,vpnMessageIsClosed:!1,appConfigSet:!1,language:""},this.appConfig=void 0}var e,n,r;return l()(t,[{key:"init",value:(r=s()(a.a.mark((function t(){var e,n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadConfig();case 2:return t.next=4,this.initSettings();case 4:return t.next=6,this.translations.update();case 6:return t.next=8,this.fallbackTranslations.update();case 8:return t.next=10,this.configs.init();case 10:return this.thanos=new U({configs:(null===(e=this.configs)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.thanosConfig)||{},browser:this.browser}),this.balance.init(),this.notification.init(),t.abrupt("return",Promise.resolve());case 14:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"initListeners",value:function(){var t=this;chrome.runtime.onMessage.addListener((function(e,n,r){var a=e.module,i=e.action,s=e.data,o=a?t[a]:t;return o&&"function"==typeof o[i]&&o[i].call(o,{data:s,sender:n,sendResponse:r}),!0}))}},{key:"analyticsHandler",value:function(){var t;this.isAnalyticsEnabled&&(t=this.analytics).send.apply(t,arguments)}},{key:"initSettings",value:(n=s()(a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_.k)("app.settings");case 2:e=t.sent,this.settings=it(it({},this.settings),e["app.settings"]);case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"loadConfig",value:(e=s()(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(H.n.APP_CONFIG_URL).then((function(t){return t.json()}));case 3:this.appConfig=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),this.appConfig={tabs:{adblock:{active:!0},vpn:{active:!1},adblockSettings:{active:!0}}};case 9:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return e.apply(this,arguments)})},{key:"saveSettings",value:function(){var t={};t["app.settings"]=this.settings,Object(_.p)(t)}},{key:"reloadTab",value:function(t){chrome.tabs.reload(t)}},{key:"sendPush",value:function(){this.notification.sendNotification({id:"enableVideo",title:this.translations.data.push_notification.video_ads.title,message:this.translations.data.push_notification.video_ads.message})}},{key:"getTranslations",value:function(t){(0,t.sendResponse)({translations:this.translations.data,lang:this.translations.language,fallbackTranslations:this.fallbackTranslations.data,fallbackLang:this.fallbackTranslations.language})}},{key:"loadContentData",value:function(t){(0,t.sendResponse)({analyticsStatusSelected:!(this.analyticsNotificationsCount<4)||this.analytics.settings.analyticsSelected})}}]),t}(),ot=n(379),ct=(n(127),n(85)),ut=n.n(ct),lt=n(41),ft=n.n(lt),ht=n(16),pt=n(15),dt=(n(303),n(67),n(392)),vt=n.n(dt),gt=n(266),mt=n.n(gt),yt=n(64),bt=n.n(yt);function wt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var a=y()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return g()(this,n)}}var kt=function(){function t(e){var n=e.name,r=e.url,a=e.options,i=e.modifiedUrl;c()(this,t),this.name=n,this.url=r,this.modifiedUrl=i,this.options=Object.assign({updateInterval:36e5,updateErrorInterval:3e4},a),this.updateTime=null,this.updateTimer=null,this.modifiedDate=null,this.updateController=null,this.maxErrorInterval=36e6}var e,n;return l()(t,[{key:"init",value:function(){var t=this;return this.load().then((function(){return t.update()}))}},{key:"parse",value:function(t){return t}},{key:"refreshUpdateTimer",value:function(t){var e=this,n=t.time,r=void 0===n?Date.now():n,a=t.interval,i=void 0===a?this.options.updateInterval:a,s=t.force;clearInterval(this.updateTimer),this.updateTime=r,this.save(),this.updateTimer=setInterval((function(){clearInterval(e.updateTimer),e.update(s)}),r+i-Date.now())}},{key:"save",value:function(){var t;Object(ht.h)((t={},w()(t,"".concat(this.name,".updateTime"),this.updateTime),w()(t,"".concat(this.name,".data"),this.data),t))}},{key:"load",value:function(){var t=this;return Object(ht.f)(["".concat(this.name,".updateTime"),"".concat(this.name,".modifiedDate"),"".concat(this.name,".data")]).then((function(e){t.updateTime=e["".concat(t.name,".updateTime")]||0,t.modifiedDate=e["".concat(t.name,".modifiedDate")]||0,t.data=e["".concat(t.name,".data")]}))}},{key:"update",value:(n=s()(a.a.mark((function t(e,n){var r,i=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.updateTime+this.options.updateInterval<Date.now()||e)){t.next=9;break}return t.next=3,this.getLastModifiedDate();case 3:if((r=t.sent)!==this.modifiedDate){t.next=6;break}return t.abrupt("return");case 6:return this.modifiedDate=r,t.next=9,this.fetch({options:n}).then((function(){i.refreshUpdateTimer({}),i.options.updateErrorInterval=3e4})).catch((function(){i.options.updateErrorInterval*=Math.floor(3*Math.random())+1,i.options.updateErrorInterval>i.maxErrorInterval&&(i.options.updateErrorInterval=i.maxErrorInterval),i.refreshUpdateTimer({interval:i.options.updateErrorInterval,force:!0})}));case 9:this.refreshUpdateTimer({time:this.updateTime});case 10:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"fetch",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){var e=this,n=t.url,r=void 0===n?this.url:n;this.updateController&&this.updateController.abort(),this.updateController=new AbortController;var a=this.updateController.signal;return fetch(r,{signal:a}).then((function(t){return t.json()})).then((function(t){return e.data=e.parse(t),e.save(),e.data})).catch((function(t){}))}))},{key:"getLastModifiedDate",value:(e=s()(a.a.mark((function t(){var e,n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(this.modifiedUrl);case 3:return e=t.sent,t.next=6,e.json();case 6:return n=t.sent,t.abrupt("return",+n.data);case 10:return t.prev=10,t.t0=t.catch(0),t.abrupt("return",0);case 14:case"end":return t.stop()}}),t,this,[[0,10]])}))),function(){return e.apply(this,arguments)})}]),t}();function xt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function St(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var a=y()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return g()(this,n)}}var Ot=function(t){d()(f,t);var e,n,r,i,o,u=St(f);function f(t){var e;c()(this,f);var n=["site","deep_link","coupon_count","config","title"].join(",");return(e=u.call(this,{name:"merchants",url:"".concat(pt.t,"?language=").concat(t.getLanguage(),"&fields=").concat(n,"&extType=").concat(t.extType,"&turnOffAffiliateOfferFilter=true"),updateDelay:144e5,modifiedUrl:pt.s})).fields=n,e.states=[],e.offersUpdateDelay=9e5,e.pingDelay=pt.u.DELAY,e.pingUpdateTime=Date.now()-e.pingDelay,e.isStore=t.isStore,e.parseMerchant=e.parseMerchant.bind(ut()(e)),e.domainsConfig=t.domainsConfig,e.extType=t.extType,e}return l()(f,[{key:"init",value:function(){var t=this;return this.load().then((function(){return t.update()}))}},{key:"parseMerchant",value:function(t){var e=L()(t,"config.IB",!this.isStore),n=L()(t,"config.ButtonCB",!0),r=L()(t,"config.ButtonCAA",!0),a=L()(t,"config.Notice",!0),i=L()(t,"config.UACB",!0),s=L()(t,"config.Serp",!0),o=L()(t,"config.ACBNA",!0),c=L()(t,"config.specialMode",!1);return{url:t.site,logo:t.logo,name:t.name,id:"".concat(t.id),network:t.network,isTopStore:t.isTopStore,activationUrl:t.deep_link,couponCount:t.coupon_count,domain:Object(_.e)(t.site.toLowerCase(),this.domainsConfig),isSerp:s,isNotifications:a,isInstallButton:e,isCAA:r,isCashback:n,isPopup:n,isACBAvailable:i,isACBNotActivated:o,fastWorking:t.fastWorking,isSM:c}}},{key:"parse",value:function(t){return t.offers.map(this.parseMerchant)}},{key:"parseCoupons",value:function(t){return $()(t.coupons,(function(t){return{id:t.id,name:t.name,description:t.description,retailerId:t.offer_id,code:t.promo_code,url:t.url,image:t.image,counter:t.counter,type:t.coupon_type,isSpecialDeal:t.is_special_deal,valid:Object(_.n)(t.active_to,"/"),validFrom:t.start_date,network:t.network}}))}},{key:"update",value:(o=s()(a.a.mark((function t(e){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h()(y()(f.prototype),"update",this).call(this,e);case 2:this.updateStates(),this.refreshPingTimer(),this.updateAdblockMerchantWhiteList();case 5:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"pingUrl",value:(i=s()(a.a.mark((function t(){var e,n,r,i,s,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(ht.f)("cashback.settings");case 2:return e=t.sent,n=e["cashback.settings"]||{},r=n.language,i=navigator.language.slice(0,2),s=new Date(this.pingUpdateTime||Date.now()-2*this.pingDelay),s=Math.floor(s/this.pingDelay)*this.pingDelay,o=new URLSearchParams({extType:this.extType,from:Math.floor(s/1e3)}),t.abrupt("return","".concat(pt.u.API_URL,"/").concat(r||i,"?").concat(o.toString()));case 9:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"refreshPingTimer",value:function(){var t=this;clearInterval(this.pingUpdateTimer),this.pingUpdateTimer=setInterval((function(){clearInterval(t.pingUpdateTimer),t.ping()}),this.pingDelay)}},{key:"ping",value:(r=s()(a.a.mark((function t(){var e,n,r,i=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.pingUrl();case 2:return e=t.sent,t.prev=3,t.next=6,fetch(e);case 6:return n=t.sent,t.next=9,n.json();case 9:r=t.sent,mt()(r.offers)||(C()(r.offers,(function(t){var e="".concat(t.id);if("1"!==t.active)x()(i.data,(function(t){return t.id===e})),x()(i.states,(function(t){return t.id===e}));else{var n=bt()(i.data,(function(t){return t.id===e})),r=i.parseMerchant(t);n?ft()(n,r):i.data.push(r)}})),this.updateAdblockMerchantWhiteList(),this.save());case 11:return t.prev=11,this.pingUpdateTime=Date.now(),this.refreshPingTimer(),t.finish(11);case 15:case"end":return t.stop()}}),t,this,[[3,,11,15]])}))),function(){return r.apply(this,arguments)})},{key:"updateMerchantOffers",value:(n=s()(a.a.mark((function t(e){var n,r,i,s,o,c,u,l,f;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.id,r=e.language,i=void 0===r?null:r,s=bt()(this.data,(function(t){return t.id===n})),(o=s&&bt()(this.states,(function(t){return t.id===n}))).offersUpdateTime=o.offersUpdateTime,s&&!(o.offersUpdateTime+this.offersUpdateDelay>nt()())){t.next=6;break}return t.abrupt("return",Promise.resolve());case 6:return c=["id","offer_id","name","promo_code","is_special_deal","active_to","url","description","geos","network"].join(","),u={fields:c,language:i,topPromocodes:!0,offer_id:n},t.next=10,fetch("".concat(pt.m,"?").concat(new URLSearchParams(u).toString()));case 10:return l=t.sent,t.next=13,l.json();case 13:return f=t.sent,s.coupons=this.parseCoupons(f),o.offersUpdateTime=nt()(),t.abrupt("return",s);case 17:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"getByUrl",value:function(t){var e=Object(_.e)(t,this.domainsConfig);if(e)return bt()(this.data,(function(n){var r=n.domain,a=n.url,i=a;return i.indexOf("https://")<-1&&i.indexOf("http://")<-1&&(i="https://".concat(a)),"/"===i.slice(-1)&&(i=i.slice(0,-1)),i.split("/").length-1==2?r===e:t.search(a)>=0}))}},{key:"getById",value:function(t){return bt()(this.data,(function(e){return e.id===t}))}},{key:"refreshStates",value:function(){C()(this.states,(function(t){ft()(t,f.defaultState())}))}},{key:"resetStates",value:function(){this.states=this.states.map((function(t){return ft()({id:t.id},f.defaultState())}))}},{key:"resetCashback",value:function(t){var e=t.id,n=bt()(this.data,(function(t){return t.id===e})),r=n&&bt()(this.states,(function(t){return t.id===e}));n&&r&&(r.activated=!1,r.showNotification=!1,r.visitedTime=null,this.setState(r))}},{key:"checkTabsOnLoading",value:(e=s()(a.a.mark((function t(e){var n,r,i=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_.l)({status:"loading"});case 2:return n=t.sent,r=n.find((function(t){var n=t.url,r=i.getByUrl(n);return L()(r,"id")===e})),t.abrupt("return",!r);case 5:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})},{key:"getMerchantAndState",value:function(t){var e=t.url,n=this.getByUrl(e),r=n&&this.states.find((function(t){return t.id===n.id}));return{merchant:n,state:r}}},{key:"updateStates",value:function(){var t=this;this.data.forEach((function(e){t.states.find((function(t){return t.id===e.id}))||t.states.push(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xt(Object(n),!0).forEach((function(e){w()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({id:e.id},f.defaultState()))}))}},{key:"updateAdblockMerchantWhiteList",value:function(){window.app.adBlock&&(window.app.caa.adblockMerchantWhiteList=P()(vt()($()(this.data,(function(t){return t.activationUrl?t.domain:null})))),window.app.adBlock.handleAdBlockMerchantsWhiteList(window.app.caa.adblockMerchantWhiteList))}}],[{key:"defaultState",value:function(){return{activated:!1,showNotification:!1,visitedTime:null}}}]),f}(function(t){d()(n,t);var e=wt(n);function n(t){var r,a=t.name,i=t.url,s=t.modifiedUrl,o=t.options,u=void 0===o?{}:o;return c()(this,n),(r=e.call(this,{name:a,url:i,modifiedUrl:s,options:u})).step=0,r.stepData=[],r}return l()(n,[{key:"fullUrl",value:function(){return"".concat(this.url).concat(this.url.includes("?")?"&":"?","step=").concat(this.step)}},{key:"next",value:function(){this.step+=1}},{key:"stop",value:function(t){return t.count<500}},{key:"reset",value:function(){this.step=0,this.stepData=[]}},{key:"fetch",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=this;return this.next(),fetch(this.fullUrl()).then((function(t){return t.json()})).then((function(e){return t.stepData=t.stepData.concat(t.parse(e)),t.stop(e)?(t.data=t.stepData.slice(),t.save(),t.reset(),t.data):t.fetch()})).catch((function(){throw t.reset(),new Error}))}))}]),n}(kt));Object(_.m)([Ot,ht.b],["update","constructor","getByUrl","refreshStates","resetStates","updateStates"]);var Dt=Ot;function Tt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var a=y()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return g()(this,n)}}var It=function(t){d()(n,t);var e=Tt(n);function n(){return c()(this,n),e.call(this,{name:"configs_CAA_caa",url:pt.j,options:{updateInterval:144e5},modifiedUrl:pt.i})}return n}(kt);function Pt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var a=y()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return g()(this,n)}}var jt=function(t){d()(n,t);var e=Pt(n);function n(){return c()(this,n),e.call(this,{name:"configs_CAA_activationParams",url:pt.c,options:{updateInterval:144e5},modifiedUrl:pt.b})}return l()(n,[{key:"parse",value:function(t){return t[0]}}]),n}(kt);function Lt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var a=y()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return g()(this,n)}}var Rt=function(t){d()(n,t);var e=Lt(n);function n(){return c()(this,n),e.call(this,{name:"configs_CAA_thanos",url:pt.H,options:{updateInterval:144e5},modifiedUrl:pt.G})}return n}(kt),Ct=(n(92),n(104)),Et=n.n(Ct),At=n(82);function _t(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var a=y()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return g()(this,n)}}var Ut=function(t){d()(n,t);var e=_t(n);function n(){return c()(this,n),e.call(this,{name:"configs_CAA_domains",url:pt.p,options:{updateInterval:144e5},modifiedUrl:pt.o})}return l()(n,[{key:"parse",value:function(t){return n.domainExtractorConfig(t)}}],[{key:"domainExtractorConfig",value:function(t){var e=[];return Et()(t,(function(t){var n=t.trigger&&new RegExp(t.trigger,"i")||Object(At.a)(t.group);Et()(t.patterns,(function(r){var a={rx:(r.rx&&new RegExp(r.rx,"i")||Object(At.a)(r.name)).source,trigger:n.source,group:t.group,name:r.name};e.push(a)}))})),e}}]),n}(kt);function Mt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var a=y()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return g()(this,n)}}var Nt=function(t){d()(n,t);var e=Mt(n);function n(){return c()(this,n),e.call(this,{name:"configs_CAA_blockingDomains",url:pt.g,options:{updateInterval:144e5},modifiedUrl:pt.f})}return n}(kt),Bt=n(306),qt=n.n(Bt);function Gt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var a=y()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return g()(this,n)}}var Vt=function(t){d()(n,t);var e=Gt(n);function n(){return c()(this,n),e.call(this,{name:"configs_CAA_terminator",url:pt.E,options:{updateInterval:144e5},modifiedUrl:pt.D})}return l()(n,[{key:"parse",value:function(t){var e=t.find((function(t){return"0"===t.id}));return t.map((function(t){var n={};return n.id=t.id,n.cookies=ft()({},t.cookies,e.cookies),n.localStorage=qt()(t.localStorage||[],e.localStorage||[]),n.sessionStorage=qt()(t.sessionStorage||[],e.sessionStorage||[]),n}))}}]),n}(kt),Ht=function(){function t(){c()(this,t),this.caa=new It,this.activationParams=new jt,this.thanos=new Rt,this.domains=new Ut,this.blockingDomains=new Nt,this.terminator=new Vt}return l()(t,[{key:"init",value:function(){return Promise.all([this.caa.init(),this.activationParams.init(),this.thanos.init(),this.domains.init(),this.blockingDomains.init(),this.terminator.init()])}}]),t}();function Ft(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var a=y()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return g()(this,n)}}var Kt=function(t){d()(i,t);var e,n,r=Ft(i);function i(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.lang,a=void 0===n?navigator.language.slice(0,2):n,s=e.prefix;return c()(this,i),t=s?r.call(this,{name:"".concat(s,"_translations_caa")}):r.call(this,{name:"translations_caa"}),Object(_.k)("app.settings").then((function(e){var n,r=(null===(n=e["app.settings"])||void 0===n?void 0:n.language)||a;pt.A.includes(r)?t.language=r:t.language=pt.n})),g()(t)}return l()(i,[{key:"setLanguage",value:(n=s()(a.a.mark((function t(e){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return pt.A.includes(e)?this.language=e:this.language=pt.n,t.next=3,this.fetch();case 3:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"fetch",value:function(){this.updateController&&this.updateController.abort(),this.updateController=new AbortController;var t=pt.J.replace("%lang%","pt_BR"===this.language?"pt-BR":this.language);return h()(y()(i.prototype),"fetch",this).call(this,{url:t})}},{key:"parse",value:function(t){return w()({},this.language,t)}},{key:"update",value:(e=s()(a.a.mark((function t(e,n){var r=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.updateTime+this.options.updateInterval<Date.now()||e)){t.next=3;break}return t.next=3,this.fetch({options:n}).then((function(){r.refreshUpdateTimer({}),r.options.updateErrorInterval=3e4})).catch((function(){r.options.updateErrorInterval*=Math.floor(3*Math.random())+1,r.options.updateErrorInterval>r.maxErrorInterval&&(r.options.updateErrorInterval=r.maxErrorInterval),r.refreshUpdateTimer({interval:r.options.updateErrorInterval,force:!0})}));case 3:this.refreshUpdateTimer({time:this.updateTime});case 4:case"end":return t.stop()}}),t,this)}))),function(t,n){return e.apply(this,arguments)})}]),i}(kt);function Wt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var a=y()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return g()(this,n)}}var Jt=function(t){d()(r,t);var e,n=Wt(r);function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c()(this,r),n.call(this,t)}return l()(r,[{key:"check",value:function(t){}},{key:"checkMerchantStatus",value:function(t){var e=this,n=t.url,r=t.tabId,a=this.merchants.getMerchantAndState({url:n}),i=a.merchant,s=a.state;if(!i)return!1;if(this.configs.terminator.data.find((function(t){return t.id===i.id}))&&this.terminator.getPageRequestsDomains({tabId:r,merchantId:i.id}),(!i.isNotifications&&Date.now()>this.settings.installTime+pt.C||i.isNotifications)&&(this.settings.activations.showCount>0||this.settings.activations.applyProgram)&&s.showNotification&&i.isACBAvailable&&!s.activated){if(!this.terminator.hasConfig(i.id)&&i.isSM)return!1;var o=this.settings.activations.applyProgram?"cashback":"no-cashback";this.activate({data:{merchantId:i.id,activationType:o,clickSource:"ac",tabId:r}})}if(!s.visitedTime){var c={visitedTime:Date.now()};this.merchants.setState({id:i.id,data:c,tabId:r}),setTimeout((function(){e.merchants.setState({id:i.id,data:{showNotification:!0},tabId:r})}),3e4)}var u=this.findActivation(r);if(!u)return!1;var l=this.resetTimers[i.id];l&&clearInterval(l),this.resetTimers[i.id]=setInterval((function(){clearInterval(l),e.merchants.resetCashback({id:i.id}),delete e.resetTimers[i.id]}),36e5);var f={activated:!!u};return this.merchants.setState({id:i.id,data:f,tabId:r}),!0}},{key:"setActivation",value:function(t){var e=this,n=t.tabId,r=t.deepLink,a=t.isBackgroundTab,i=t.merchantId,s=this.activations.find((function(t){return t.tabId===n}));s||(s={tabId:n},this.activations.push(s)),clearTimeout(s.timer),s.isBackgroundTab=a,s.deeplink=s.deepLink||r,s.timer=setTimeout((function(){e.terminator.tabRequestController({tabId:n,merchantId:i},!0),chrome.tabs.remove(n,(function(){e.activations=e.activations.filter((function(t){return t.tabId!==n}))}))}),45e3),this.merchants.setState({url:r,id:i,data:{activated:!0}}),x()(this.activationPool,(function(t){return t===i}))}},{key:"activate",value:(e=s()(a.a.mark((function t(e){var n,r,i,s,o,c,u,l,f,h,p,d,v=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.data,r=n.merchantId,i=n.activationType,s=n.sa2,o=void 0===s?"":s,c=n.clickSource,u=void 0===c?"":c,l=n.tabId,!this.merchants.states.find((function(t){return t.id===r})).activated){t.next=5;break}return t.abrupt("return");case 5:if(!bt()(this.activationPool,(function(t){return t===r}))){t.next=7;break}return t.abrupt("return");case 7:if(this.activationPool.push(r),!i.includes("cashback")){t.next=17;break}return t.prev=9,t.next=12,this.terminator.terminate({merchantId:r,sender:{},activeTab:l});case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(9);case 17:return t.next=19,this.transactionService.createTransaction({merchantId:r,activationType:i,sa2:o});case 19:if(f=t.sent,h=f.deepLink){t.next=23;break}return t.abrupt("return");case 23:return i.includes("cashback")&&"ac"!==u&&this.hideNotification(i),p="".concat(pt.w).concat(encodeURIComponent(h)),"firefox"===this.browser||"opera"===this.browser?chrome.tabs.create({url:p,active:!1},(function(t){var e=t.id;v.setActivation({tabId:e,deepLink:h,isBackgroundTab:!0,merchantId:r})})):(d="yabrowser"===this.browser?"panel":"normal",chrome.windows.create({url:p,state:"minimized",type:d},(function(t){v.setActivation({tabId:t.tabs[0].id,deepLink:h,isBackgroundTab:!0,merchantId:r})}))),t.abrupt("return",!0);case 27:case"end":return t.stop()}}),t,this,[[9,14]])}))),function(t){return e.apply(this,arguments)})},{key:"findActivation",value:function(t){return this.activations.find((function(e){return e.tabId===t}))}}]),r}(ht.d),Yt=n(393),zt=n(394),$t=n.n(zt),Xt=n(395),Zt=n.n(Xt),Qt=n(129),te=n.n(Qt),ee=n(396),ne=n.n(ee);function re(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ae(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?re(Object(n),!0).forEach((function(e){w()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ie=function(){function t(e){var n=e.sendMerchantVisitAnalytics;c()(this,t),this.name="sessions",this.dataKey="".concat(this.name,".data"),this.sessions=[],this.sendMerchantVisitAnalytics=n,this.loadSessionsFromStorage(),this.saveSessionsToStorage=te()(this.saveSessionsToStorage,2e3),this.sortSessions=te()(this.sortSessions,1e3)}var e;return l()(t,[{key:"loadSessionsFromStorage",value:(e=s()(a.a.mark((function t(){var e,n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(ht.f)(this.dataKey);case 2:(e=t.sent)&&(n=e[this.dataKey]||[],this.sessions=n.map((function(t){return Zt()(t,["id","activated"])})),this.sortSessions());case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"saveSessionsToStorage",value:function(){Object(ht.h)(w()({},this.dataKey,this.sessions))}},{key:"cleanSessionsStorage",value:function(){this.sessions=[],Object(ht.h)(w()({},this.dataKey,[]))}},{key:"resetSessionId",value:function(t){var e=t.merchantId;Et()(this.sessions,(function(t){t.merchantId===e&&delete t.id})),this.saveSessionsToStorage()}},{key:"sortSessions",value:function(){this.sessions=ne()(this.sessions,(function(t){return t.lastVisitTime||0}),["desc"])}},{key:"updateSession",value:function(t){var e=t.merchantId,n=t.data,r=void 0===n?{}:n;if(e){var a=this.getSessionByMerchantId(e),i=L()(a,"id");if(a){var s=a.id,o=void 0===s?ht.a.uuidv4():s;ft()(a,{id:o},r,{ts:Date.now()})}else{var c=r.id,u=void 0===c?ht.a.uuidv4():c,l=r.activated,f=void 0!==l&&l;a=ae(ae({},$t()(r,["id","activated"])),{},{id:u,merchantId:e,ts:Date.now(),activated:f}),this.sessions.push(a)}var h=L()(a,"id");h&&i!==h&&this.sendMerchantVisitAnalytics({session:a}),this.sortSessions(),this.saveSessionsToStorage()}}},{key:"getRecentSessions",value:function(t){var e=t.count,n=void 0===e?10:e;return this.sessions.slice(0,n).filter((function(t){return t.lastVisitTime}))}},{key:"getSessionByMerchantId",value:function(t){return this.sessions.find((function(e){return e.merchantId===t}))}}]),t}(),se=n(397),oe=new Error("token is empty"),ce=new Error("refresh token is empty"),ue=new Error("unable to update refresh token");function le(t){return{accessToken:t.access_token,refreshToken:t.refresh_token,expiresIn:t.expires_in,issuedAt:t.issued_at}}var fe=function(){function t(){c()(this,t),this.isAuthenticated=!1,this.tokenStorageKey="auth.token"}var e,n,r,i;return l()(t,[{key:"setAuthenticatedStatus",value:function(t){this.isAuthenticated=t}},{key:"refreshToken",value:(i=s()(a.a.mark((function t(e){var n,r,i,s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}throw oe;case 2:if(e.refreshToken){t.next=4;break}throw ce;case 4:return n={method:"POST",headers:{Authorization:"Bearer ".concat(e.refreshToken)}},t.prev=5,t.next=8,fetch(pt.x,n);case 8:return r=t.sent,t.next=11,r.json();case 11:return i=t.sent,s=le(i),t.next=15,this.setAuthToken(s);case 15:return t.abrupt("return",s);case 18:throw t.prev=18,t.t0=t.catch(5),this.setAuthenticatedStatus(!1),ue;case 22:case"end":return t.stop()}}),t,this,[[5,18]])}))),function(t){return i.apply(this,arguments)})},{key:"getAuthHeader",value:(r=s()(a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getAuthToken();case 2:if(!(1e3*(e=t.sent).expiresIn-new Date<0)){t.next=8;break}return t.next=7,this.refreshToken(e);case 7:e=t.sent;case 8:return t.abrupt("return",{Authorization:"Bearer ".concat(e.accessToken)});case 9:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"getAuthToken",value:(n=s()(a.a.mark((function t(){var e,n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(ht.f)(this.tokenStorageKey);case 3:if(e=t.sent,(n=e[this.tokenStorageKey])&&n.accessToken){t.next=8;break}return this.setAuthenticatedStatus(!1),t.abrupt("return",void 0);case 8:return t.abrupt("return",n);case 11:return t.prev=11,t.t0=t.catch(0),t.abrupt("return",null);case 14:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return n.apply(this,arguments)})},{key:"setAuthToken",value:(e=s()(a.a.mark((function t(e){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e||!e.accessToken){t.next=6;break}return t.next=3,Object(_.q)(w()({},this.tokenStorageKey,e));case 3:this.setAuthenticatedStatus(!0),t.next=9;break;case 6:return t.next=8,Object(_.q)(w()({},this.tokenStorageKey,null));case 8:this.setAuthenticatedStatus(!1);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}]),t}(),he=function(){function t(e){c()(this,t),this.name="terminator",this.dataKey="CAA_".concat(this.name,".merchantDomains"),this.merchantDomains={},this.merchantRequestListeners={},this.merchantRequestControllerListeners={},this.activations=e.activations,this.configs=e.configs,this.merchants=e.merchants,this.getMerchantAndState=e.getMerchantAndState,this.loadDomainsFromStorage(),this.throttledSetStorageData=te()(ht.h,2e3),this.fixZero()}var e,n,r;return l()(t,[{key:"loadDomainsFromStorage",value:(r=s()(a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(ht.f)(this.dataKey);case 2:(e=t.sent)&&(this.merchantDomains=e[this.dataKey]||{});case 4:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"hasConfig",value:function(t){return!!this.configs.find((function(e){return e.id===t}))}},{key:"getPageRequestsDomains",value:function(t){var e=this,n=t.tabId,r=t.merchantId,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i={urls:["<all_urls>"],tabId:n,types:["main_frame","sub_frame","image","script"]},s=function(t){var n=e.merchantDomains[r]||{data:{}},a=new URL(t.url).origin;return n.data[a]=Date.now(),e.merchantDomains[r]=n,/(t_tid=)|(t_s=)/gi.test(t.url)?{cancel:!0}:{cancel:!1}};this.merchantRequestListeners[r]||(this.merchantRequestListeners[r]={listener:s}),a?chrome.webRequest.onBeforeRequest.removeListener(this.merchantRequestListeners[r].listener):L()(this.merchantRequestListeners[r],"tabId")||(chrome.webRequest.onBeforeRequest.addListener(this.merchantRequestListeners[r].listener,i,["blocking"]),this.merchantRequestListeners[r].tabId=!0)}},{key:"tabRequestController",value:function(t){var e=this,n=t.merchantId,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a={urls:["<all_urls>"],types:["sub_frame","image","script"]},i=function(t){var r=t.tabId,a=t.url,i=Object.keys(e.getMerchantTabs(n)),s=e.activations.find((function(t){return t.tabId===r})),o=e.merchants.getByUrl(a);return!i.includes(String(r))||s||o?{cancel:!1}:{cancel:!0}};this.merchantRequestControllerListeners[n]||(this.merchantRequestControllerListeners[n]={listener:i}),r?chrome.webRequest.onBeforeRequest.removeListener(this.merchantRequestControllerListeners[n].listener):L()(this.merchantRequestControllerListeners[n],"tabId")||(chrome.webRequest.onBeforeRequest.addListener(this.merchantRequestControllerListeners[n].listener,a,["blocking"]),this.merchantRequestControllerListeners[n].tabId=!0)}},{key:"getMerchantTabs",value:function(t){var e=this;return new Promise(function(){var n=s()(a.a.mark((function n(r){var i,s;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i={},n.next=3,Object(At.c)({});case 3:return s=n.sent,n.next=6,C()(s,(function(n){var r;(null===(r=e.merchants.getByUrl(n.url))||void 0===r?void 0:r.id)===t&&(i[n.id]=!0)}));case 6:r(i);case 7:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())}},{key:"awaitTabLoaded",value:(n=s()(a.a.mark((function t(e){var n=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=mt.a,t.next=3,this.getMerchantTabs(e);case 3:if(t.t1=t.sent,!(0,t.t0)(t.t1)){t.next=6;break}return t.abrupt("return","skip");case 6:return t.abrupt("return",new Promise((function(t){var r,i=setInterval(s()(a.a.mark((function s(){var o;return a.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.merchants.checkTabsOnLoading(e);case 2:o=a.sent,Object.keys(L()(n.merchantDomains,"".concat(e,".data"),{})).length>0&&o&&(clearInterval(i),clearTimeout(r),n.throttledSetStorageData(w()({},n.dataKey,n.merchantDomains)),t());case 4:case"end":return a.stop()}}),s)}))),1e3);r=setTimeout((function(){clearInterval(i),clearTimeout(r),n.throttledSetStorageData(w()({},n.dataKey,n.merchantDomains)),t()}),12e4)})));case 7:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"terminate",value:(e=s()(a.a.mark((function t(e){var n,r,i,o,c,u,l,f,h,p,d,v,g=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.merchantId,r=e.sender,i=void 0===r?{}:r,o=e.activeTab,c=this.configs.find((function(t){return t.id===n}))){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,this.awaitTabLoaded(n);case 6:if("skip"!==t.sent){t.next=9;break}return t.abrupt("return");case 9:return u=L()(i,"tab.id",o),this.getPageRequestsDomains({tabId:o,merchantId:n},!0),this.tabRequestController({tabId:o,merchantId:n},!1),l="\n    (() => {\n      const clearStorage = (storage, config) => {\n        if (config[0] !== '*') {\n          const storageKeys = { ...storage };\n          config.forEach((configKey) => {\n            if (storageKeys[configKey]) {\n              delete storageKeys[configKey];\n            }\n          });\n          Object.keys(storageKeys).forEach((key) => {\n            storage.removeItem(key);\n          });\n        }\n        };\n        const localConfig = ".concat(JSON.stringify(c.localStorage),";\n        const sessionConfig = ").concat(JSON.stringify(c.sessionStorage),";\n        clearStorage(localStorage, localConfig);\n        clearStorage(sessionStorage, sessionConfig);\n    })()\n    "),chrome.tabs.executeScript(u,{code:l,allFrames:!0,runAt:"document_end"}),f=this.merchantDomains[n].data,h=f&&Object.keys(f),p=c.cookies,d=Object.keys(p),v=h.map(function(){var t=s()(a.a.mark((function t(e){var n,r,i,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Date.now()-f[e]>pt.F&&delete f[e],n=g.merchants.getByUrl(e),r=n?{domain:n.domain}:{url:e},t.next=5,Object(At.b)(r);case 5:return i=t.sent,o=i.map(function(){var t=s()(a.a.mark((function t(n){var r,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!0,i=d.find((function(t){return n.domain.includes(t)})),p[i]&&(1===p[i].length&&"*"===p[i][0]?r=!1:p[i].forEach((function(t){t===n.name&&(r=!1)}))),r&&chrome.cookies.remove({url:e,name:n.name});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=9,Promise.all(o);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=21,Promise.all(v);case 21:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"fixZero",value:function(){chrome.webRequest.onBeforeRequest.addListener((function(t){var e=t.url,n=new URL(e);return/(iw=)|(ih=)|(t_tid=)|(t_s=)/gi.test(e)?(n.searchParams.set("ih",window.screen.availHeight),n.searchParams.set("iw",window.screen.availWidth),{redirectUrl:n.toString()}):{cancel:!1}}),{urls:["*://*/*"],types:["image","script","sub_frame","object","xmlhttprequest","ping","other"]},["blocking"])}}]),t}();function pe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function de(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pe(Object(n),!0).forEach((function(e){w()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ve(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var a=y()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return g()(this,n)}}var ge=function(t){d()(v,t);var e,n,r,i,o,u,f,h,p=ve(v);function v(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c()(this,v),(t=p.call(this,e)).userInfo=null,t.name="caa.core",t.authService=new fe,t.configs=new Ht,t.translations=new Kt,t.sessionsStore=new ie({sendMerchantVisitAnalytics:t.sendMerchantVisitAnalytics.bind(ut()(t))}),t.settings={isAnalyticsEnabled:!0,showGa:!0,activations:{show:!0,showCount:0,lastShow:0,applyProgram:!1},installTime:Date.now()},t.transactionService=new Yt.a({authService:t.authService,sessionsStore:t.sessionsStore}),t.analytics=new se.a({transactionService:t.transactionService,sessionsStore:t.sessionsStore,settings:t.settings,getLanguage:t.getLanguage.bind(ut()(t))}),t.setEventListeners(),t.resetTimers={},t.activations=[],t.activationPool=[],t.browserSessionGaSliderShow=!0,t.transactionService.init().then((function(){t.configs.init().then((function(){t.merchants=new Dt({getLanguage:t.getLanguage.bind(ut()(t)),domainsConfig:t.configs.domains.data,extType:e.extType}),t.terminator=new he({tabs:t.tabs,activations:t.activations,configs:t.configs.terminator.data,merchants:t.merchants,getMerchantAndState:t.merchants.getMerchantAndState.bind(ut()(t))}),t.init()}))})),t}return l()(v,[{key:"init",value:(h=s()(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.merchants.init(),this.translations.init(),this.blockTrackers(),this.loadSettings();case 4:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)})},{key:"setEventListeners",value:(f=s()(a.a.mark((function t(){var e=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:chrome.tabs.onUpdated.addListener((function(t,n,r){var a=r.url;"loading"===n.status&&e.checkMerchantStatus({url:a,tabId:t}),e.updateIcon(t)})),chrome.runtime.onInstalled.addListener(function(){var t=s()(a.a.mark((function t(n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"install"===n.reason&&e.settings.isAnalyticsEnabled&&(e.analytics.send({ec:"Extension",ea:"Install"}),chrome.management.getAll((function(t){var n=t.map((function(t){return t.id}));e.analytics.send({ec:"Management",ea:"Installed",el:JSON.stringify(n)})})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),chrome.tabs.onActivated.addListener((function(t){var n=t.tabId;return e.updateIcon(n)}));case 3:case"end":return t.stop()}}),t)}))),function(){return f.apply(this,arguments)})},{key:"setMessagesListener",value:function(){var t=this;chrome.runtime.onMessage.addListener((function(e,n,r){var a=e.module,i=e.action,s=e.data,o=a?t[a]:t;return o&&"function"==typeof o[i]&&o[i].call(o,{data:s,sender:n,sendResponse:r}),!0}))}},{key:"toggleGa",value:function(t){var e=this,n=t.data.isEnabled;this.setSettings({isAnalyticsEnabled:n}),this.settings.isAnalyticsEnabled&&(this.analytics.send({ec:"Extension",ea:"Install"}),chrome.management.getAll((function(t){var n=t.map((function(t){return t.id}));e.analytics.send({ec:"Management",ea:"Installed",el:JSON.stringify(n)})})))}},{key:"hideGaPopup",value:function(){this.setSettings({showGa:!1})}},{key:"openHomePage",value:function(){chrome.tabs.create({url:pt.q})}},{key:"hideSessionGaPopup",value:function(){this.browserSessionGaSliderShow=!1}},{key:"sendAnalytics",value:function(t){var e=t.data;this.settings.isAnalyticsEnabled&&this.analytics.send(e)}},{key:"sendCaaAnalytics",value:function(t){var e=t.data;this.settings.isAnalyticsEnabled&&(this.analytics.send(e.ga),e.caaAnalytics&&fetch(pt.h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.caaAnalytics)}))}},{key:"updateIcon",value:(u=s()(a.a.mark((function t(e){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case 1:case"end":return t.stop()}}),t)}))),function(t){return u.apply(this,arguments)})},{key:"updateMerchantState",value:function(t){var e=t.data,n=t.sender,r=void 0===n?{}:n;this.merchants.setState({url:r.url,id:e.id,data:e.state}),this.updateIcon()}},{key:"getCurrentMerchant",value:(o=s()(a.a.mark((function t(){var e,n,r,i,s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(ht.e)();case 2:return e=t.sent,n=e.url,r=this.merchants.getMerchantAndState({url:n}),i=r.merchant,s=r.state,t.abrupt("return",i?ft()({},s,i):null);case 6:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"getMerchant",value:function(t){var e=t.data;(0,t.sendResponse)(this.merchants.getByUrl(e.url)||null)}},{key:"initContent",value:(i=s()(a.a.mark((function t(e){var n,r,i,s,o,c,u,l;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.sender,r=e.sendResponse,i=n.url,s=this.merchants.getMerchantAndState({url:i}),o=s.merchant,c=s.state,!o){t.next=6;break}return t.next=6,this.merchants.updateMerchantOffers({id:o.id,language:this.translations.language});case 6:u=this.settings.showGa&&!this.settings.isAnalyticsEnabled&&this.browserSessionGaSliderShow,l={settings:this.settings,merchant:o?de(de({},c),o):null,configs:this.configs.caa.data,showGa:u},r(l);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"saveSettings",value:function(){var t={};t["".concat(this.name,".settings")]=this.settings,Object(_.p)(t)}},{key:"getOffers",value:(r=s()(a.a.mark((function t(e){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.deals.data.filter((function(t){return t.slug===e})));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"changeLanguage",value:(n=s()(a.a.mark((function t(e){var n,r,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.data,r=e.sendResponse,i=n.language,t.next=4,this.saveSettings({language:i});case 4:r(!0);case 5:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"getLocale",value:function(){return this.translations.language}},{key:"getLanguage",value:function(){return navigator.language.slice(0,2)}},{key:"getI18n",value:function(){return{locale:this.getLocale(),translations:this.translations.data}}},{key:"sendMerchantVisitAnalytics",value:function(t){var e=t.session;if(this.analytics){var n=this.merchants.getById(e.merchantId),r=L()(n,"name");this.analytics.sendMerchantVisit({session:e,merchantName:r})}}},{key:"sendStatusCoupons",value:function(t){var e=t.data;this.analytics&&fetch(pt.z,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})}},{key:"blockTrackers",value:function(){return this.configs.blockingDomains.data&&0!==this.configs.blockingDomains.data.length?(chrome.webRequest.onBeforeRequest.addListener((function(){return{cancel:!0}}),{urls:this.configs.blockingDomains.data},["blocking"]),!0):setTimeout(this.blockTrackers.bind(this),1e4)}},{key:"updateMerchant",value:function(t){var e=t.sender,n=t.sendResponse,r=e.url,a=this.merchants.getMerchantAndState({url:r}),i=a.merchant,s=a.state;n({merchant:i?de(de({},s),i):null})}},{key:"setSettings",value:function(t){Object.assign(this.settings,t)}},{key:"hideNotification",value:function(t){if("cashback"===t)this.settings.activations.show=!1,this.settings.activations.applyProgram=!0;else{if(!pt.a[this.settings.activations.showCount])return void(this.settings.activations.show=!1);this.settings.activations.lastShow=Date.now(),this.settings.activations.showCount+=1}this.saveSettings()}},{key:"loadSettings",value:(e=s()(a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_.k)("".concat(this.name,".settings"));case 2:e=t.sent,this.settings=de(de({},this.settings),e["".concat(this.name,".settings")]),this.saveSettings();case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),v}(Jt),me=(n(94),n(25)),ye=n.n(me),be=(n(59),n(60),n(5));function we(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var a=y()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return g()(this,n)}}var ke=function(t){d()(n,t);var e=we(n);function n(){return c()(this,n),e.call(this,{name:"flightConfigs",url:"https://savematic.com/api/configs/avia",updateDelay:36e5,errorDelay:6e5})}return n}(function(){function t(e){c()(this,t);var n=e.name,r=e.url,a=e.options,i=e.updateDelay,s=e.errorDelay;this.name=n,this.url=r,this.options=a||{},this.updateDelay=i||144e5,this.errorDelay=s||this.updateDelay/10,this.data=[]}return l()(t,[{key:"parse",value:function(t){return t}},{key:"fetch",value:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){var n=e?Object.assign(this.options,e):this.options;return fetch(t||this.url,n).then((function(t){return t.json()}))}))},{key:"update",value:function(t){var e=this;return clearInterval(this.updateInterval),Object(be.d)(["".concat(this.name,".lastUpdate"),"".concat(this.name,".data")]).then((function(n){var r=n["".concat(e.name,".lastUpdate")],a=n["".concat(e.name,".data")],i=(new Date).getTime();if(r+e.updateDelay>=i&&a&&!t){e.data=a;var s=r+e.updateDelay-i;return e.updateInterval=setInterval((function(){return e.update()}),s),e.data}return e.fetch().then((function(t){return e.parse(t)})).then((function(t){if(t){e.data=t;var n={};n["".concat(e.name,".data")]=t,n["".concat(e.name,".lastUpdate")]=i,Object(be.n)(n),e.updateInterval=setInterval((function(){return e.update()}),e.updateDelay)}else{var r=e.data?e.errorDelay:e.errorDelay/10;e.updateInterval=setInterval((function(){return e.update(!0)}),r)}return e.data})).catch((function(t){var n=e.data?e.errorDelay:e.errorDelay/10;e.updateInterval=setInterval((function(){return e.update(!0)}),n)}))}))}}]),t}()),xe=function(){function t(e){var n=e.language;c()(this,t),this.languages={},this.setLanguage(n)}var e,n;return l()(t,[{key:"setLanguage",value:(n=s()(a.a.mark((function t(e){var n,r=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("ru-RU"===e&&(e="ru"),!this.languages[e]){t.next=6;break}this.data=this.languages[e],this.language=e,t.next=24;break;case 6:return t.prev=6,t.next=9,this.fetch(e);case 9:if(n=t.sent){t.next=12;break}return t.abrupt("return");case 12:this.data=n,this.data.common.dayNames=JSON.parse(this.data.common.dayNames),this.data.common.monthNames=JSON.parse(this.data.common.monthNames),this.languages[e]=this.data,this.language=e,Object(be.n)(w()({},"translations.".concat(e),this.data)),t.next=24;break;case 20:t.prev=20,t.t0=t.catch(6),Object(be.d)("translations.".concat(e)).then((function(t){t&&(r.data=t)}));case 24:case"end":return t.stop()}}),t,this,[[6,20]])}))),function(t){return n.apply(this,arguments)})},{key:"getLanguageWithoutSetting",value:(e=s()(a.a.mark((function t(e){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.languages[e]){t.next=2;break}return t.abrupt("return",this.languages[e]);case 2:return t.prev=2,t.next=5,this.fetch(e);case 5:if(n=t.sent){t.next=8;break}return t.abrupt("return",this.data);case 8:return(r=n).common.dayNames=JSON.parse(n.common.dayNames),r.common.monthNames=JSON.parse(n.common.monthNames),this.languages[e]=r,Object(be.n)(w()({},"translations.".concat(e),r)),t.abrupt("return",r);case 16:return t.prev=16,t.t0=t.catch(2),t.abrupt("return",this.data);case 19:case"end":return t.stop()}}),t,this,[[2,16]])}))),function(t){return e.apply(this,arguments)})},{key:"fetch",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){var e="https://cdn.translations.savematic.com/translations/flight/".concat(t,"/translation.json");return fetch(e).then((function(t){return t.json()}))}))}]),t}();function Se(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Oe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Se(Object(n),!0).forEach((function(e){w()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var De=function(){function t(e){var n=e.language,r=void 0===n?navigator.language:n;c()(this,t),this.configs=new ke,this.translations=new xe({language:r}),this.configs.update(),this.setMessagesListener(),this.mutedTabs={},this.searchesData={}}var e,n,r,i,o,u,f,h;return l()(t,[{key:"setMessagesListener",value:function(){var t=this;chrome.runtime.onMessage.addListener((function(e,n,r){var a=e.module,i=e.action,s=e.data,o=a?t[a]:t;return o&&"function"==typeof o[i]&&o[i].call(o,{data:s,sender:n,sendResponse:r}),!0}))}},{key:"setLocaleFlight",value:(h=s()(a.a.mark((function t(e){var n,r,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.data,r=e.sendResponse,i=n.locale,t.next=4,this.translations.setLanguage(i);case 4:r(this.translations.data);case 5:case"end":return t.stop()}}),t,this)}))),function(t){return h.apply(this,arguments)})},{key:"getCurrentTranslationsFlight",value:function(t){(0,t.sendResponse)({locale:this.translations.language,translations:w()({},this.translations.language,this.translations.data)})}},{key:"getTranslationsFlight",value:(f=s()(a.a.mark((function t(e){var n,r,i,s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.data,r=e.sendResponse,i=n.locale,t.next=5,this.translations.getLanguageWithoutSetting(i);case 5:s=t.sent,r(s);case 7:case"end":return t.stop()}}),t,this)}))),function(t){return f.apply(this,arguments)})},{key:"initContentFlight",value:(u=s()(a.a.mark((function t(e){var n,r,i,s,o,c,u,l;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.sender,r=e.sendResponse,t.next=3,Object(be.d)("currency");case 3:return i=t.sent,s=i.currency,t.next=7,Object(be.d)("userLocale");case 7:o=t.sent,c=o.userLocale,u=new URL(n.url).hostname,(l=this.mutedTabs[n.tab.id])?"pending"===l?this.mutedTabs[n.tab.id]=u:l!==u?(delete this.mutedTabs[n.tab.id],r({configs:this.configs.data,currency:s,userLocale:c})):r(null):r({configs:this.configs.data,currency:s,userLocale:c});case 12:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"getSearchDataFlight",value:(o=s()(a.a.mark((function t(e){var n,r,i,s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.data,r=e.sendResponse,i=n.query,t.next=5,fetch("https://savematic.com/api/travel/flightSearch",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then((function(t){return t.json()}));case 5:s=t.sent,r(s);case 7:case"end":return t.stop()}}),t)}))),function(t){return o.apply(this,arguments)})},{key:"getListFlight",value:(i=s()(a.a.mark((function t(e){var n,r,i,o,c,u,l,f,h=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.data,r=e.sendResponse,i=n.searchId,o=n.currencyRate,c=this.translations.data,this.searchesData[i]||(this.searchesData[i]={proposals:[],airlines:{},airports:{},tickets:{}}),u=[],l={},f={},setTimeout(s()(a.a.mark((function t(){var e,n,s,p,d,v,g;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://savematic.com/api/travel/flightSearchResults?searchId=".concat(i)).then((function(t){return t.json()}));case 2:if((e=t.sent)&&e.length){t.next=6;break}return r({isLoading:!1}),t.abrupt("return");case 6:e.forEach((function(t){t&&t.proposals?(Object.assign(l,t.airlines),Object.assign(f,t.airports),t.proposals.forEach((function(e){if(Object.values(t.gates_info)[0].id&&e){var n=Object(be.k)({price:Object.values(e.terms)[0].unified_price,rate:o}),a=Object.values(e.terms)[0].url,s=Object.values(t.gates_info)[0].label,c=Object.values(t.gates_info)[0].payment_methods;h.searchesData[i].tickets[e.sign]||(h.searchesData[i].tickets[e.sign]=[]),h.searchesData[i].tickets[e.sign].push({url:a,price:n,label:s,xterms:e.xterms});var l=0,f=[],p=null,d=null;e.segment.forEach((function(t,e){l+=t.rating.total,f.push(t.transfers?t.transfers.length:0),0===e?p=t.transfers:1===e&&(d=t.transfers)}));var v=Object.values(e.terms)[0];v.price=n;var g=Object.values(e.xterms)[0],m=Object(be.g)(v),y=Object(be.h)(Object.entries(g),o),b=Object(be.f)({luggageInfo:m,luggageOption:y});u.push({carriers:e.carriers,segment:e.segment,segment_durations:e.segment_durations,is_direct:e.is_direct,tags:e.tags||[],terms:v,xterms:g,gates_info:Object.values(t.gates_info)[0],popularity:e.popularity,sign:e.sign,rating:l,transfersCounts:f,luggageInfo:m,luggageOption:y,luggageFilter:b,directTransfers:p,backTransfers:d,label:s,paymentMethods:c})}else r({isLoading:!1})}))):r({isLoading:!1})})),h.searchesData[i].airlines=Oe(Oe({},h.searchesData[i].airlines),l),h.searchesData[i].airports=Oe(Oe({},h.searchesData[i].airports),f),h.searchesData[i].proposals=[].concat(ye()(h.searchesData[i].proposals),u),n=ye()(h.searchesData[i].proposals).sort((function(t,e){return t.terms.price-e.terms.price})),s=n.filter((function(t){return t.is_direct})),p=ye()(n).sort((function(t,e){return e.rating-t.rating})),d=s[0],v=p[0],g=(g=[Oe(Oe({},n[0]),{},{title:c.options.cheapest,color:"#39B200"}),Oe(Oe({},v),{},{title:c.options.popular,color:"#9B51E0"})].concat(ye()(n.slice(1)))).filter((function(t){return g.find((function(e){return e.sign===t.sign}))})),d&&g.splice(1,0,Oe(Oe({},d),{},{title:c.options.direct,color:"#EF0000"})),r({tickets:h.searchesData[i].tickets,airlines:l,airports:f,proposals:u,directProposal:d,optimalProposal:v,ticketsProposals:g,isLoading:!0});case 19:case"end":return t.stop()}}),t)}))),1e3),setTimeout((function(){delete h.searchesData[i]}),6e5);case 10:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"openTicketPageFlight",value:(r=s()(a.a.mark((function t(e){var n,r,i,s,o,c,u,l=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.data,r=e.sendResponse,i=e.sender,s=n.searchId,o=n.url,c=n.label,u=n.event;try{u&&(u.data.seller=c,this.sendAnalyticsFlight({data:Oe({},u),sender:i})),chrome.tabs.create({url:"https://savematic.com/travel/click?searchId=".concat(s,"&url=").concat(o,"&seller=").concat(c)},(function(t){l.mutedTabs[t.id]="pending"})),r(!0)}catch(t){r(!1)}case 3:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"getSuggestionsFlight",value:(n=s()(a.a.mark((function t(e){var n,r,i,s,o,c;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.data,r=e.sendResponse,i=n.query,s=n.locale,t.next=4,fetch("https://savematic.com/api/travel/autocompleteAirports?q=".concat(i,"&locale=").concat(s)).then((function(t){return t.json()}));case 4:o=t.sent,c=o.map((function(t){return{name:t.city_fullname,key:t.code}})),r(c);case 7:case"end":return t.stop()}}),t)}))),function(t){return n.apply(this,arguments)})},{key:"getCityKeyByNameFlight",value:(e=s()(a.a.mark((function t(e){var n,r,i,s,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.data,r=e.sendResponse,i=n.value,t.next=4,fetch("https://savematic.com/api/travel/autocompleteAirports?q=".concat(i)).then((function(t){return t.json()}));case 4:s=t.sent,o=s[0].code,r(o);case 7:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})},{key:"sendAnalyticsFlight",value:function(t){var e=t.data,n=t.sender,r=new URL(n.url).hostname,a={extensionId:chrome.runtime.id,extensionVersion:chrome.runtime.getManifest().version,domain:r};fetch("https://analytics.savematic.com/api/travel/actionLog",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(Oe(Oe({},e),a))})}},{key:"sendParserLogFlight",value:function(t){var e=t.data,n=t.sender,r=n.url,a=new URL(n.url).hostname,i={extensionId:chrome.runtime.id,extensionVersion:chrome.runtime.getManifest().version,domain:a,url:r};fetch("https://analytics.savematic.com/api/travel/parserLog",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(Oe(Oe({},e),i))})}}]),t}();function Te(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var a=y()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return g()(this,n)}}var Ie=function(t){d()(v,t);var e,n,r,i,o,u,f,p=Te(v);function v(){var t;return c()(this,v),(t=p.call(this)).app="vpn",t.vpn=new ot.a,t.caa=new ge({activationPatterns:pt.d,suppressionPatterns:pt.B,extType:"vpn"}),t.flight=new De({language:navigator.language}),t.init().then(s()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.initListeners();case 1:case"end":return e.stop()}}),e)})))),t.cachedCoordinates={lat:"",lng:"",lang:""},t.cachedMap="",t}return l()(v,[{key:"init",value:(f=s()(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h()(y()(v.prototype),"init",this).call(this);case 2:this.thanos.toggleVpns();case 3:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)})},{key:"closeVpnMessage",value:function(){this.settings.vpnMessageIsClosed=!0,this.saveSettings()}},{key:"getLocations",value:(u=s()(a.a.mark((function t(e){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.sendResponse,t.next=3,this.vpn.countries.update(!0);case 3:return t.abrupt("return",n({locations:this.vpn.countries.data,lastLocations:this.vpn.settings.lastLoations,rsLocations:this.vpn.residential.data}));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"getGeoInfo",value:(o=s()(a.a.mark((function t(e){var n,r,i,s,o,c;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.sendResponse,0!==(null===(n=this.vpn)||void 0===n||null===(r=n.connectedProxy)||void 0===r?void 0:r.latitude)){t.next=9;break}return t.next=4,this.getCoordinates();case 4:s=t.sent,o=s.lat,c=s.lng,this.vpn.connectedProxy.latitude=o,this.vpn.connectedProxy.longitude=c;case 9:i({geoInfo:"on"===this.vpn.settings.status&&this.vpn.fakeGeo.ip&&this.vpn.connectedProxy&&Object.assign({ip:this.vpn.fakeGeo.ip},this.vpn.connectedProxy)||this.vpn.settings.realGeoIP});case 10:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"clearHistory",value:function(t){var e=t.data,n=t.sendResponse;this.vpn.usageStatistic.clearHistory(e),n()}},{key:"toggleAnalytics",value:function(t){this.vpn.analytics.toggleAnalytics(t)}},{key:"getGeocodeInfo",value:(i=s()(a.a.mark((function t(e){var n,r,i,s,o,c,u,l,f,h;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.sendResponse,c=null===(n=this.vpn)||void 0===n||null===(r=n.connectedProxy)||void 0===r?void 0:r.latitude,u=null===(i=this.vpn)||void 0===i||null===(s=i.connectedProxy)||void 0===s?void 0:s.longitude,c&&u){t.next=9;break}return t.next=6,this.getCoordinates();case 6:l=t.sent,c=l.lat,u=l.lng;case 9:if(this.cachedCoordinates.lat!==c||this.cachedCoordinates.lng!==u||this.cachedCoordinates.lang!==this.settings.language||!this.cachedGeoInfo){t.next=12;break}return o(this.cachedGeoInfo),t.abrupt("return");case 12:return t.next=14,fetch("https://maps.googleapis.com/maps/api/geocode/json?language=".concat(this.settings.language,"&latlng=").concat(c,",").concat(u,"&key=").concat(H.e)).then((function(t){return t.json()}));case 14:f=t.sent,h=this.parseLocation(f),this.cachedGeoInfo=h,o(h);case 18:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"parseLocation",value:function(t){var e={country:"",code:"",region:"",city:""};return t.results.forEach((function(t){var n,r,a,i;e.country=(null===(n=t.address_components.find((function(t){return t.types.includes("country")})))||void 0===n?void 0:n.long_name)||e.country,e.code=(null===(r=t.address_components.find((function(t){return t.types.includes("country")})))||void 0===r?void 0:r.short_name)||e.code,e.region=(null===(a=t.address_components.find((function(t){return t.types.includes("administrative_area_level_1")})))||void 0===a?void 0:a.long_name)||e.region,e.city=(null===(i=t.address_components.find((function(t){return t.types.includes("administrative_area_level_2")})))||void 0===i?void 0:i.long_name)||e.city})),e}},{key:"getCoordinates",value:(r=s()(a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://www.googleapis.com/geolocation/v1/geolocate?key=".concat(H.e),{method:"POST"}).then((function(t){return t.json()}));case 2:return e=t.sent,t.abrupt("return",e.location);case 4:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"getGoogleMap",value:(n=s()(a.a.mark((function t(e){var n,r,i,s,o,c,u,l,f,h,p=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.sendResponse,c=null===(n=this.vpn)||void 0===n||null===(r=n.connectedProxy)||void 0===r?void 0:r.latitude,u=null===(i=this.vpn)||void 0===i||null===(s=i.connectedProxy)||void 0===s?void 0:s.longitude,c&&u){t.next=9;break}return t.next=6,this.getCoordinates();case 6:l=t.sent,c=l.lat,u=l.lng;case 9:if(this.cachedCoordinates.lat!==c||this.cachedCoordinates.lng!==u||this.cachedCoordinates.lang!==this.settings.language||!this.cachedMap){t.next=12;break}return o(this.cachedMap),t.abrupt("return");case 12:return t.next=14,fetch("https://maps.googleapis.com/maps/api/staticmap?language=".concat(this.settings.language,"&center=").concat(c,",").concat(u,"&zoom=13&size=376x241&maptype=roadmap&markers=color:0x235ff5%7C").concat(c,",").concat(u,"&key=").concat(H.e)).then((function(t){return t.blob()}));case 14:f=t.sent,(h=new FileReader).readAsDataURL(f),h.onloadend=function(){var t=h.result;p.cachedMap=t,p.cachedCoordinates.lat=c,p.cachedCoordinates.lng=u,p.cachedCoordinates.lang=p.settings.language,o(t)};case 18:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"getI18n",value:function(t){(0,t.sendResponse)(this.caa.getI18n(this.settings.language))}},{key:"initContent",value:function(t){var e=t.sender,n=t.sendResponse;this.caa.initContent({sender:e,sendResponse:n})}},{key:"sendCaaAnalytics",value:function(t){var e=t.data;this.caa.sendCaaAnalytics({data:e})}},{key:"selectLanguage",value:(e=s()(a.a.mark((function t(e){var n,r,i,s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.data,s=e.sendResponse,this.settings.language=i,t.next=4,this.translations.setLanguage(i);case 4:null===(n=this.caa)||void 0===n||null===(r=n.translations)||void 0===r||r.setLanguage(i),this.saveSettings(),s(this.translations.data);case 7:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"withdraw",value:function(){chrome.cookies.set({domain:H.f,secure:!0,url:H.g,name:"extension",value:"".concat(this.vpn.analytics.extId,":").concat(this.vpn.analytics.expPw)},(function(){chrome.tabs.create({url:H.h})}))}}]),v}(st);window.app=new Ie},8:function(t,e,n){"use strict";n.d(e,"k",(function(){return v})),n.d(e,"p",(function(){return g})),n.d(e,"o",(function(){return m})),n.d(e,"g",(function(){return y})),n.d(e,"h",(function(){return b})),n.d(e,"i",(function(){return k})),n.d(e,"e",(function(){return S})),n.d(e,"a",(function(){return I})),n.d(e,"j",(function(){return T})),n.d(e,"c",(function(){return j})),n.d(e,"m",(function(){return O})),n.d(e,"q",(function(){return D})),n.d(e,"n",(function(){return w})),n.d(e,"l",(function(){return x})),n.d(e,"b",(function(){return L})),n.d(e,"d",(function(){return P})),n.d(e,"f",(function(){return R}));n(50),n(101),n(58),n(91),n(27),n(29),n(30),n(34),n(35),n(36),n(33),n(47),n(37),n(38),n(20),n(24),n(92);var r=n(7),a=n.n(r),i=(n(17),n(18),n(31),n(39),n(1)),s=n.n(i),o=(n(40),n(21),n(4)),c=n.n(o),u=(n(102),n(67),n(19)),l=n.n(u);n(49),n(10),n(74),n(26);function f(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){o=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw i}}}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){a()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v=function(t){return new Promise((function(e,n){chrome.storage.local.get(t,(function(t){chrome.runtime.lastError?n(new Error("Error in storage.get: ".concat(chrome.runtime.lastError))):e(t)}))}))},g=function(t){chrome.storage.local.set(t)},m=function(t){return new Promise((function(e){chrome.runtime.sendMessage(t,(function(t){e(t)}))}))},y=function(){return new Promise((function(t){chrome.tabs.query({active:!0,currentWindow:!0},(function(e){var n=l()(e,1)[0];return t(n)}))}))},b=function(){return new Promise((function(t){return chrome.tabs.query({},(function(e){return t(e)}))}))},w=function(t){var e=new Date(t),n=e.getDate()>9?e.getDate():"0".concat(e.getDate()),r=e.getMonth()>8?e.getMonth()+1:"0".concat(e.getMonth()+1);return"".concat(n,"-").concat(r,"-").concat(e.getFullYear())},k=function(){return-1!==navigator.userAgent.indexOf("Chrome")?-1!==(navigator.userAgent.indexOf("Opera")&&navigator.userAgent.indexOf("OPR"))?"opera":-1!==navigator.userAgent.indexOf("YaBrowser")?"yabrowser":"chrome":-1!==navigator.userAgent.indexOf("Firefox")?"firefox":-1!==navigator.userAgent.indexOf("Safari")?"safari":null},x=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new Promise((function(e){chrome.tabs.query(t,(function(t){return e(t)}))}));return e},S=function(t,e){if(!t)return null;try{var n,r=function(t){var e=t.toLowerCase();/^https?:\/\/.*/i.test(e)||(e="https://".concat(e));var n=new URL(e),r=n.host,a=n.pathname;return a?r+a:r}(t),a=f(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(new RegExp(i.trigger,"i").test(r)){var s=new RegExp(i.rx,"i").exec(r);if(s&&s[1])return s[1]}}}catch(t){a.e(t)}finally{a.f()}var o=/(?:^www\.)?(([\w-]+)(\.(\w{2,3}|xn--\w{4,6}))*(\.\w*)?)(\/.*)*(\?.*)?$/i.exec(r);return o?o[1]:null}catch(t){return null}},O=function(t){var e=l()(t,2),n=e[0],r=e[1],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];return Object.getOwnPropertyNames(r.prototype).filter((function(t){return!a.includes(t)})).forEach((function(t){n.prototype[t]=r.prototype[t]})),n},D=function(t){return new Promise((function(e){chrome.storage.local.set(t,(function(t){e(t)}))}))},T=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return(Date.now()-t)/36e5},I=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;setTimeout(t,e)},P=function(){var t=c()(s.a.mark((function t(e){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){return setTimeout((function(){return t(!0)}),e)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),j=function(t){var e=t.selector,n=t.parentNode,r=document.createElement("div");r.className=e,n.parentNode.append(r);var a=r.attachShadow({mode:"open"});return a.innerHTML='\n    <style>\n    @import url("'.concat(chrome.extension.getURL("content/styles.css"),'");\n    @import url("').concat(chrome.extension.getURL("caa/styles.css"),'");\n    </style>\n    <div id="').concat(e,'"></div>'),a},L=function(t){var e=document.createElement("input");e.style.position="absolute",document.body.appendChild(e),e.value=t,e.select(),document.execCommand("Copy"),document.body.removeChild(e)},R=function(){var t=c()(s.a.mark((function t(e){var n,r,a,i,o,c,u=arguments;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:{},r=n.timeout,a=void 0===r?1e4:r,i=new AbortController,o=setTimeout((function(){return i.abort()}),a),t.next=6,fetch(e,d(d({},n),{},{signal:i.signal}));case 6:return c=t.sent,clearTimeout(o),t.abrupt("return",c);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},82:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return c}));n(17),n(50),n(101),n(33),n(58),n(91),n(27),n(29),n(30);var r=n(1),a=n.n(r),i=(n(67),n(40),n(21),n(4)),s=n.n(i);n(49),n(10),n(55),n(92);var o=function(t){return new RegExp("(?:(?:^https|^http):\\/\\/|)?(?:.*\\.)*(".concat(t.replace(/\./g,"\\."),")(\\/.*)*(\\?.*)?$"),"i")},c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new Promise((function(e){chrome.tabs.query(t,(function(t){return e(t)}))}));return e},u=function(t){return new Promise((function(e){var n=setInterval(s()(a.a.mark((function r(){return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,c({status:"loading"});case 2:r.sent.find((function(e){return 0===e.url.indexOf(t.url)}))||(clearInterval(n),chrome.cookies.getAll(t,e));case 4:case"end":return r.stop()}}),r)}))),1e3)}))}}});